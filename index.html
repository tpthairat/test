<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary SEO Meta Tags -->
    <title>Flash Sale ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå | ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô</title>
    <meta name="title" content="Flash Sale ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå | ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô">
    <meta name="description" content="‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå Flash Sale ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ iPhone Samsung ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå MacBook ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô ‡πÄ‡∏Å‡∏° ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏ó‡∏¢">
    <meta name="keywords" content="flash sale, ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå, ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤, ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠, iPhone, Samsung, ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå, MacBook, ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô, ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô, ‡πÄ‡∏Å‡∏°, ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û, ‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á, ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ, ‡πÑ‡∏ó‡∏¢">
    <meta name="robots" content="index, follow">
    <meta name="language" content="Thai">
    <meta name="author" content="Flash Sale Thailand">
    <meta name="copyright" content="Flash Sale Thailand">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://flashsale-thailand.com/">
    <meta property="og:title" content="Flash Sale ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå | ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô">
    <meta property="og:description" content="‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå Flash Sale ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ iPhone Samsung ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå MacBook ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô ‡πÄ‡∏Å‡∏° ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏ó‡∏¢">
    <meta property="og:image" content="https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=1200&h=630">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Flash Sale Thailand">
    <meta property="og:locale" content="th_TH">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://flashsale-thailand.com/">
    <meta property="twitter:title" content="Flash Sale ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå | ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô">
    <meta property="twitter:description" content="‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå Flash Sale ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ iPhone Samsung ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå MacBook ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô ‡πÄ‡∏Å‡∏° ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏ó‡∏¢">
    <meta property="twitter:image" content="https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=1200&h=630">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://flashsale-thailand.com/">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõçÔ∏è</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõçÔ∏è</text></svg>">
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://images.unsplash.com">
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    
    <!-- DNS Prefetch -->
    <link rel="dns-prefetch" href="//shopee.co.th">
    <link rel="dns-prefetch" href="//lazada.co.th">
    <link rel="dns-prefetch" href="//www.gstatic.com">
    
    <!-- Structured Data - Organization -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Flash Sale Thailand",
      "url": "https://flashsale-thailand.com",
      "logo": "https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=400",
      "description": "‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå Flash Sale ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "123 ‡∏ñ‡∏ô‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ ‡πÅ‡∏Ç‡∏ß‡∏á‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°",
        "addressLocality": "‡πÄ‡∏Ç‡∏ï‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•",
        "addressRegion": "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø",
        "postalCode": "10110",
        "addressCountry": "TH"
      },
      "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "+66-2-123-4567",
        "contactType": "customer service",
        "availableLanguage": "Thai"
      },
      "sameAs": [
        "https://www.facebook.com/flashsalethailand",
        "https://www.instagram.com/flashsalethailand",
        "https://twitter.com/flashsaleth"
      ]
    }
    </script>
    
    <!-- Structured Data - WebSite -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Flash Sale Thailand",
      "url": "https://flashsale-thailand.com",
      "description": "‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå Flash Sale ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://flashsale-thailand.com/search?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    
    <!-- Structured Data - Store -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Store",
      "name": "Flash Sale Thailand",
      "image": "https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=400",
      "description": "‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå Flash Sale ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "123 ‡∏ñ‡∏ô‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ ‡πÅ‡∏Ç‡∏ß‡∏á‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°",
        "addressLocality": "‡πÄ‡∏Ç‡∏ï‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•",
        "addressRegion": "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø",
        "postalCode": "10110",
        "addressCountry": "TH"
      },
      "geo": {
        "@type": "GeoCoordinates",
        "latitude": "13.7563",
        "longitude": "100.5018"
      },
      "telephone": "+66-2-123-4567",
      "openingHoursSpecification": {
        "@type": "OpeningHoursSpecification",
        "dayOfWeek": [
          "Monday",
          "Tuesday", 
          "Wednesday",
          "Thursday",
          "Friday"
        ],
        "opens": "09:00",
        "closes": "18:00"
      },
      "priceRange": "‡∏ø‡∏ø"
    }
    </script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    <style>
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .loading {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .hero-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .category-active {
            background-color: #3b82f6;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-4">
                    <h1 class="text-2xl font-bold text-blue-600 cursor-pointer" onclick="showPage('home')">üõçÔ∏è Flash Sale</h1>
                </div>
                <div class="hidden md:flex items-center space-x-6">
                    <a href="#" onclick="showPage('home')" class="text-gray-700 hover:text-blue-600 transition">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
                    
                    <!-- Flash Sale Dropdown -->
                    <div class="relative group">
                        <button class="text-gray-700 hover:text-blue-600 transition flex items-center">
                            ‚ö° Flash Sale
                            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div class="absolute left-0 mt-2 w-48 bg-white rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                            <div class="py-1">
                                <a href="#" onclick="showFlashSale('main')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600">üî• Flash Sale ‡∏´‡∏•‡∏±‡∏Å</a>
                                <a href="#" onclick="showFlashSale('today')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600">üìÖ Flash Sale ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</a>
                                <a href="#" onclick="showFlashSale('weekend')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600">üéØ Flash Sale ‡∏™‡∏∏‡∏î‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</a>
                                <a href="#" onclick="showFlashSale('mega')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600">üí• Mega Flash Sale</a>
                            </div>
                        </div>
                    </div>

                    <!-- ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô Dropdown -->
                    <div class="relative group">
                        <button class="text-gray-700 hover:text-blue-600 transition flex items-center">
                            üéÅ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô
                            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div class="absolute left-0 mt-2 w-56 bg-white rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                            <div class="py-1">
                                <a href="#" onclick="showPromotion('mobile')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600">üì± ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</a>
                                <a href="#" onclick="showPromotion('computer')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600">üíª ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</a>
                                <a href="#" onclick="showPromotion('fashion')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600">üëó ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô</a>
                                <a href="#" onclick="showPromotion('mother')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600">üë∂ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å</a>
                                <a href="#" onclick="showPromotion('home')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600">üè† ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô</a>
                                <a href="#" onclick="showPromotion('health')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600">üíä ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</a>
                            </div>
                        </div>
                    </div>

                    <!-- ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ Dropdown -->
                    <div class="relative group">
                        <button class="text-gray-700 hover:text-blue-600 transition flex items-center">
                            üõí ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤
                            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div class="absolute left-0 mt-2 w-40 bg-white rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                            <div class="py-1">
                                <a href="https://shopee.co.th" target="_blank" class="block px-4 py-2 text-sm text-gray-700 hover:bg-orange-50 hover:text-orange-600">üü† Shopee</a>
                                <a href="https://lazada.co.th" target="_blank" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600">üîµ Lazada</a>
                                <a href="https://tiktok.com/shop" target="_blank" class="block px-4 py-2 text-sm text-gray-700 hover:bg-pink-50 hover:text-pink-600">‚ö´ TikTok Shop</a>
                            </div>
                        </div>
                    </div>

                    <a href="#" onclick="showPage('about')" class="text-gray-700 hover:text-blue-600 transition">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</a>
                    <a href="#" onclick="showPage('contact')" class="text-gray-700 hover:text-blue-600 transition">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="cartBtn" class="relative bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                        üõí ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ (<span id="cartCount">0</span>)
                    </button>
                    <button id="adminBtn" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition">
                        üë§ ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div id="heroSection" class="hero-gradient text-white py-12">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <h1 class="text-3xl font-bold mb-4">Flash Sale ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70%</h1>
            <h2 class="text-lg mb-6">‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ iPhone Samsung ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå MacBook ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô ‡πÄ‡∏Å‡∏° ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏ó‡∏¢</h2>
            <button onclick="showPage('products')" class="bg-white text-blue-600 px-6 py-2 rounded-lg font-semibold hover:bg-gray-100 transition">
                ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡πÄ‡∏•‡∏¢
            </button>
        </div>
    </div>

    <!-- Breadcrumb Navigation -->
    <nav id="breadcrumb" class="max-w-7xl mx-auto px-4 py-2 text-sm text-gray-600 hidden">
        <div class="flex items-center space-x-2">
            <a href="#" onclick="showPage('home')" class="hover:text-blue-600">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
            <span>/</span>
            <span id="breadcrumbCurrent">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</span>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 py-8">
        <!-- Home Page -->
        <div id="homePage" class="fade-in">


            <!-- Popular Categories Section -->
            <div class="mb-12">
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
                    <div onclick="showPage('products'); filterByCategory('mobile')" class="bg-white p-6 rounded-lg shadow-md text-center cursor-pointer hover:shadow-lg transition transform hover:scale-105">
                        <div class="text-4xl mb-3">üì±</div>
                        <h3 class="font-semibold">‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</h3>
                        <p class="text-sm text-gray-500">‡∏™‡∏°‡∏≤‡∏£‡πå‡∏ó‡πÇ‡∏ü‡∏ô</p>
                    </div>
                    <div onclick="showPage('products'); filterByCategory('computer')" class="bg-white p-6 rounded-lg shadow-md text-center cursor-pointer hover:shadow-lg transition transform hover:scale-105">
                        <div class="text-4xl mb-3">üíª</div>
                        <h3 class="font-semibold">‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</h3>
                        <p class="text-sm text-gray-500">‡πÅ‡∏•‡πá‡∏õ‡∏ó‡πá‡∏≠‡∏õ PC</p>
                    </div>
                    <div onclick="showPage('products'); filterByCategory('fashion')" class="bg-white p-6 rounded-lg shadow-md text-center cursor-pointer hover:shadow-lg transition transform hover:scale-105">
                        <div class="text-4xl mb-3">üëó</div>
                        <h3 class="font-semibold">‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô</h3>
                        <p class="text-sm text-gray-500">‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤</p>
                    </div>
                    <div onclick="showPage('products'); filterByCategory('mother')" class="bg-white p-6 rounded-lg shadow-md text-center cursor-pointer hover:shadow-lg transition transform hover:scale-105">
                        <div class="text-4xl mb-3">üë∂</div>
                        <h3 class="font-semibold">‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å</h3>
                        <p class="text-sm text-gray-500">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å</p>
                    </div>
                    <div onclick="showPage('products'); filterByCategory('home')" class="bg-white p-6 rounded-lg shadow-md text-center cursor-pointer hover:shadow-lg transition transform hover:scale-105">
                        <div class="text-4xl mb-3">üè†</div>
                        <h3 class="font-semibold">‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô</h3>
                        <p class="text-sm text-gray-500">‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô</p>
                    </div>
                    <div onclick="showPage('products'); filterByCategory('health')" class="bg-white p-6 rounded-lg shadow-md text-center cursor-pointer hover:shadow-lg transition transform hover:scale-105">
                        <div class="text-4xl mb-3">üíä</div>
                        <h3 class="font-semibold">‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</h3>
                        <p class="text-sm text-gray-500">‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏™‡∏£‡∏¥‡∏°</p>
                    </div>
                </div>
            </div>

            <!-- Featured Products by Category -->
            <div class="space-y-12">
                <!-- Mobile Products -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold flex items-center">
                            <span class="text-3xl mr-3">üì±</span>
                            ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ iPhone Samsung ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤ Flash Sale
                        </h3>
                        <button onclick="showPage('products'); filterByCategory('mobile')" class="text-blue-600 hover:text-blue-800 font-medium">
                            ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Üí
                        </button>
                    </div>
                    <div id="mobileProducts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    </div>
                </div>

                <!-- Computer Products -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold flex items-center">
                            <span class="text-3xl mr-3">üíª</span>
                            ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå MacBook ‡πÅ‡∏•‡πá‡∏õ‡∏ó‡πá‡∏≠‡∏õ ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤
                        </h3>
                        <button onclick="showPage('products'); filterByCategory('computer')" class="text-blue-600 hover:text-blue-800 font-medium">
                            ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Üí
                        </button>
                    </div>
                    <div id="computerProducts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    </div>
                </div>

                <!-- Fashion Products -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold flex items-center">
                            <span class="text-3xl mr-3">üëó</span>
                            ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô ‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤ ‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤ ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤
                        </h3>
                        <button onclick="showPage('products'); filterByCategory('fashion')" class="text-blue-600 hover:text-blue-800 font-medium">
                            ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Üí
                        </button>
                    </div>
                    <div id="fashionProducts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    </div>
                </div>

                <!-- Mother Products -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold flex items-center">
                            <span class="text-3xl mr-3">üë∂</span>
                            ‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å ‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏î‡πá‡∏Å ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤
                        </h3>
                        <button onclick="showPage('products'); filterByCategory('mother')" class="text-blue-600 hover:text-blue-800 font-medium">
                            ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Üí
                        </button>
                    </div>
                    <div id="motherProducts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    </div>
                </div>

                <!-- Home Products -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold flex items-center">
                            <span class="text-3xl mr-3">üè†</span>
                            ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô ‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤
                        </h3>
                        <button onclick="showPage('products'); filterByCategory('home')" class="text-blue-600 hover:text-blue-800 font-medium">
                            ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Üí
                        </button>
                    </div>
                    <div id="homeProducts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    </div>
                </div>

                <!-- Health Products -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold flex items-center">
                            <span class="text-3xl mr-3">üíä</span>
                            ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏™‡∏£‡∏¥‡∏° ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤
                        </h3>
                        <button onclick="showPage('products'); filterByCategory('health')" class="text-blue-600 hover:text-blue-800 font-medium">
                            ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Üí
                        </button>
                    </div>
                    <div id="healthProducts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    </div>
                </div>
            </div>
        </div>

        <!-- Products Page -->
        <div id="productsPage" class="hidden">
            <!-- Category Filter -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold mb-4">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                <div class="flex flex-wrap gap-2" id="categoryFilter">
                    <button onclick="filterByCategory('all')" class="category-btn category-active px-4 py-2 rounded-lg border transition">
                        ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                    </button>
                    <button onclick="filterByCategory('mobile')" class="category-btn px-4 py-2 rounded-lg border hover:bg-blue-600 hover:text-white transition">
                        üì± ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠
                    </button>
                    <button onclick="filterByCategory('computer')" class="category-btn px-4 py-2 rounded-lg border hover:bg-blue-600 hover:text-white transition">
                        üíª ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå
                    </button>
                    <button onclick="filterByCategory('fashion')" class="category-btn px-4 py-2 rounded-lg border hover:bg-blue-600 hover:text-white transition">
                        üëó ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô
                    </button>
                    <button onclick="filterByCategory('mother')" class="category-btn px-4 py-2 rounded-lg border hover:bg-blue-600 hover:text-white transition">
                        üë∂ ‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å
                    </button>
                    <button onclick="filterByCategory('home')" class="category-btn px-4 py-2 rounded-lg border hover:bg-blue-600 hover:text-white transition">
                        üè† ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô
                    </button>
                    <button onclick="filterByCategory('health')" class="category-btn px-4 py-2 rounded-lg border hover:bg-blue-600 hover:text-white transition">
                        üíä ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û
                    </button>
                </div>
            </div>

            <!-- Loading Spinner -->
            <div id="loadingSpinner" class="flex justify-center items-center py-20">
                <div class="loading"></div>
                <span class="ml-4 text-gray-600">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤...</span>
            </div>

            <!-- Products Grid -->
            <div id="productsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 hidden">
            </div>

            <!-- Empty State -->
            <div id="emptyState" class="text-center py-20 hidden">
                <div class="text-6xl mb-4">üì¶</div>
                <h3 class="text-xl font-semibold text-gray-600 mb-2">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                <p class="text-gray-500">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</p>
            </div>
        </div>

        <!-- About Page -->
        <div id="aboutPage" class="hidden fade-in">
            <div class="bg-white rounded-lg shadow-md p-8">
                <h1 class="text-3xl font-bold mb-6 text-center">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö Flash Sale Thailand ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</h1>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h2 class="text-xl font-semibold mb-4">üè™ Flash Sale Thailand ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ä‡∏±‡πâ‡∏ô‡∏ô‡∏≥</h2>
                        <p class="text-gray-600 mb-4">
                            Flash Sale Thailand ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏°‡∏∏‡πà‡∏á‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á 
                            ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ iPhone Samsung ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå MacBook 
                            ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô ‡πÄ‡∏Å‡∏° ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏ó‡∏¢
                        </p>
                        <p class="text-gray-600">
                            ‡πÄ‡∏£‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏£‡∏£‡∏° 
                            ‡∏à‡∏∂‡∏á‡∏Ñ‡∏±‡∏î‡∏™‡∏£‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡∏ä‡∏±‡πâ‡∏ô‡∏ô‡∏≥‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏£‡∏£‡πÉ‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤ Flash Sale ‡∏û‡∏¥‡πÄ‡∏®‡∏©
                        </p>
                    </div>
                    <div>
                        <h2 class="text-xl font-semibold mb-4">üéØ ‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Flash Sale Thailand</h2>
                        <ul class="text-gray-600 space-y-2">
                            <li>‚Ä¢ ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</li>
                            <li>‚Ä¢ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡∏ä‡∏±‡πâ‡∏ô‡∏ô‡∏≥</li>
                            <li>‚Ä¢ ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏ó‡∏¢ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡∏£‡∏ö‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</li>
                            <li>‚Ä¢ ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡∏•‡∏≠‡∏î 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</li>
                            <li>‚Ä¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</li>
                            <li>‚Ä¢ Flash Sale ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</li>
                        </ul>
                    </div>
                </div>
                
                <!-- SEO Content Section -->
                <div class="mt-8 border-t pt-8">
                    <h2 class="text-2xl font-bold mb-4">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ Flash Sale ‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="p-4 bg-blue-50 rounded-lg">
                            <h3 class="font-semibold mb-2">üì± ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ iPhone Samsung</h3>
                            <p class="text-sm text-gray-600">‡∏™‡∏°‡∏≤‡∏£‡πå‡∏ó‡πÇ‡∏ü‡∏ô‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î iPhone 15, Samsung Galaxy S24 ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏©</p>
                        </div>
                        <div class="p-4 bg-green-50 rounded-lg">
                            <h3 class="font-semibold mb-2">üíª ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå MacBook</h3>
                            <p class="text-sm text-gray-600">‡πÅ‡∏•‡πá‡∏õ‡∏ó‡πá‡∏≠‡∏õ MacBook, Dell, ASUS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°</p>
                        </div>
                        <div class="p-4 bg-pink-50 rounded-lg">
                            <h3 class="font-semibold mb-2">üëó ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô ‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤</h3>
                            <p class="text-sm text-gray-600">‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô ‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤ ‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤ ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ ‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Flash Sale Page -->
        <div id="flashSalePage" class="hidden fade-in">
            <div class="bg-gradient-to-r from-red-500 to-orange-500 text-white p-8 rounded-lg mb-8">
                <h2 class="text-4xl font-bold mb-4 text-center">‚ö° Flash Sale</h2>
                <div id="flashSaleTitle" class="text-xl text-center mb-4">üî• Flash Sale ‡∏´‡∏•‡∏±‡∏Å</div>
                <div class="text-center">
                    <div class="inline-flex items-center bg-white text-red-600 px-6 py-2 rounded-full font-bold">
                        ‚è∞ ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ß‡∏•‡∏≤: <span id="countdown" class="ml-2">23:59:45</span>
                    </div>
                </div>
            </div>
            
            <div id="flashSaleProducts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            </div>
        </div>

        <!-- Promotion Page -->
        <div id="promotionPage" class="hidden fade-in">
            <div class="bg-gradient-to-r from-purple-500 to-pink-500 text-white p-4 rounded-lg mb-8">
                <h2 class="text-2xl font-bold mb-2 text-center">üéÅ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</h2>
                <div id="promotionTitle" class="text-lg text-center mb-2">üì± ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</div>
                <div class="text-center">
                    <div class="inline-flex items-center bg-white text-purple-600 px-4 py-1 rounded-full font-bold text-sm">
                        üéØ ‡∏•‡∏î‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 30%
                    </div>
                </div>
            </div>
            
            <div id="promotionProducts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            </div>
        </div>



        <!-- Contact Page -->
        <div id="contactPage" class="hidden fade-in">
            <div class="bg-white rounded-lg shadow-md p-8">
                <h2 class="text-3xl font-bold mb-6 text-center">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-xl font-semibold mb-4">üìû ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</h3>
                        <div class="space-y-4">
                            <div class="flex items-center space-x-3">
                                <span class="text-2xl">üìç</span>
                                <div>
                                    <p class="font-medium">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</p>
                                    <p class="text-gray-600">123 ‡∏ñ‡∏ô‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ ‡πÅ‡∏Ç‡∏ß‡∏á‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏° ‡πÄ‡∏Ç‡∏ï‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏• ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10110</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <span class="text-2xl">üìû</span>
                                <div>
                                    <p class="font-medium">‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</p>
                                    <p class="text-gray-600">02-123-4567</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <span class="text-2xl">üìß</span>
                                <div>
                                    <p class="font-medium">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</p>
                                    <p class="text-gray-600">info@flashsale.com</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <span class="text-2xl">üïí</span>
                                <div>
                                    <p class="font-medium">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</p>
                                    <p class="text-gray-600">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå-‡∏®‡∏∏‡∏Å‡∏£‡πå 9:00-18:00 ‡∏ô.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold mb-4">üí¨ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡πÄ‡∏£‡∏≤</h3>
                        <form class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠</label>
                                <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                                <input type="email" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</label>
                                <textarea rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                            </div>
                            <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition">
                                ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Modal -->
    <div id="cartModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-2xl w-full max-h-96 overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold">üõí ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                        <button id="closeCartModal" class="text-gray-500 hover:text-gray-700">‚úï</button>
                    </div>
                    <div id="cartItems"></div>
                    <div class="border-t pt-4 mt-4">
                        <div class="flex justify-between items-center text-lg font-bold">
                            <span>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                            <span id="cartTotal">‡∏ø0</span>
                        </div>
                        <div id="cartPurchaseButtons" class="mt-4">
                            <!-- Purchase buttons will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="adminModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div id="adminModalContent" class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto cursor-move" style="user-select: none;">
                <div class="p-6">
                    <div id="modalHeader" class="flex justify-between items-center mb-4 p-2 bg-gray-50 rounded-lg cursor-move select-none">
                        <h2 class="text-xl font-bold">üë§ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h2>
                        <div class="flex items-center space-x-2">
                            <span class="text-xs text-gray-500">üñ±Ô∏è ‡∏•‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡πâ‡∏≤‡∏¢</span>
                            <button id="closeAdminModal" class="text-gray-500 hover:text-gray-700 cursor-pointer">‚úï</button>
                        </div>
                    </div>
                    <div id="loginForm">
                        <div class="mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                            <p class="text-sm text-yellow-800">
                                <strong>üîß ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Firebase:</strong><br>
                                1. ‡∏™‡∏£‡πâ‡∏≤‡∏á Project ‡πÉ‡∏ô Firebase Console<br>
                                2. ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ Authentication & Firestore<br>
                                3. ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà Firebase Config ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î<br>
                                <strong>Demo:</strong> admin@demo.com / admin123
                            </p>
                        </div>
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                            <input type="email" id="adminEmail" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="admin@example.com">
                        </div>
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
                            <input type="password" id="adminPassword" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                        </div>
                        <button id="loginBtn" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition">
                            ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                        </button>
                    </div>
                    <div id="adminPanel" class="hidden">
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold mb-4">üõ†Ô∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå</h3>
                            <div class="grid grid-cols-3 gap-2 mb-4">
                                <button onclick="showAdminSection('products')" id="adminProductsBtn" class="admin-section-btn bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                                    üì¶ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                                </button>
                                <button onclick="showAdminSection('linkpreview')" id="adminLinkPreviewBtn" class="admin-section-btn bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                                    üîó Link Preview
                                </button>
                                <button onclick="showAdminSection('pages')" id="adminPagesBtn" class="admin-section-btn bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">
                                    üìÑ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
                                </button>
                            </div>
                        </div>

                        <!-- Product Management -->
                        <div id="adminProductsSection" class="mb-4">
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                                <!-- Left Column -->
                                <div class="space-y-4">
                                    <!-- Auto Generate Products -->
                                    <div class="p-3 bg-blue-50 rounded-lg border border-blue-200">
                                        <h4 class="text-sm font-semibold mb-2 text-blue-800">ü§ñ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</h4>
                                        <div class="grid grid-cols-2 gap-2 mb-2">
                                            <select id="autoCategory" class="px-2 py-1 border border-gray-300 rounded text-xs">
                                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>
                                                <option value="mobile">üì± ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</option>
                                                <option value="computer">üíª ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</option>
                                                <option value="fashion">üëó ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô</option>
                                                <option value="mother">üë∂ ‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å</option>
                                                <option value="home">üè† ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô</option>
                                                <option value="health">üíä ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</option>
                                            </select>
                                            <input type="number" id="autoCount" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (1-20)" min="1" max="20" value="5" class="px-2 py-1 border border-gray-300 rounded text-xs">
                                        </div>
                                        <button id="generateProductsBtn" class="w-full bg-blue-600 text-white py-1 rounded hover:bg-blue-700 transition text-xs">
                                            üöÄ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
                                        </button>
                                    </div>

                                    <!-- Bulk Actions -->
                                    <div class="p-3 bg-yellow-50 rounded-lg border border-yellow-200">
                                        <h4 class="text-sm font-semibold mb-2 text-yellow-800">‚ö° ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å</h4>
                                        <div class="grid grid-cols-2 gap-2 mb-2">
                                            <select id="bulkCategory" class="px-2 py-1 border border-gray-300 rounded text-xs">
                                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>
                                                <option value="mobile">üì± ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</option>
                                                <option value="computer">üíª ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</option>
                                                <option value="fashion">üëó ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô</option>
                                                <option value="mother">üë∂ ‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å</option>
                                                <option value="home">üè† ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô</option>
                                                <option value="health">üíä ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</option>
                                            </select>
                                            <input type="number" id="bulkPriceMultiplier" placeholder="‡∏Ñ‡∏π‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô 1.1)" step="0.1" min="0.1" max="10" value="1" class="px-2 py-1 border border-gray-300 rounded text-xs">
                                        </div>
                                        <div class="grid grid-cols-2 gap-2">
                                            <button id="bulkUpdatePriceBtn" class="bg-orange-600 text-white py-1 rounded hover:bg-orange-700 transition text-xs">
                                                üí∞ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏Ñ‡∏≤
                                            </button>
                                            <button id="bulkDeleteBtn" class="bg-red-600 text-white py-1 rounded hover:bg-red-700 transition text-xs">
                                                üóëÔ∏è ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                                            </button>
                                        </div>
                                    </div>

                                    <!-- Product Statistics -->
                                    <div class="p-3 bg-green-50 rounded-lg border border-green-200">
                                        <h4 class="text-sm font-semibold mb-2 text-green-800">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h4>
                                        <div id="productStats" class="grid grid-cols-2 gap-2 text-xs">
                                            <div class="text-center">
                                                <div class="text-lg font-bold text-green-600" id="totalProducts">0</div>
                                                <div class="text-gray-600">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                                            </div>
                                            <div class="text-center">
                                                <div class="text-lg font-bold text-blue-600" id="avgPrice">‡∏ø0</div>
                                                <div class="text-gray-600">‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</div>
                                            </div>
                                        </div>
                                        <div id="categoryStats" class="mt-2 text-xs space-y-1">
                                        </div>
                                    </div>
                                </div>

                                <!-- Right Column -->
                                <div class="space-y-4">
                                    <!-- Product Management List -->
                                    <div class="p-3 bg-indigo-50 rounded-lg border border-indigo-200">
                                        <h4 class="text-sm font-semibold mb-2 text-indigo-800">üìù ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà</h4>
                                        <div class="mb-2">
                                            <select id="manageCategory" class="w-full px-2 py-1 border border-gray-300 rounded text-xs">
                                                <option value="">‡∏î‡∏π‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                                <option value="mobile">üì± ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</option>
                                                <option value="computer">üíª ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</option>
                                                <option value="fashion">üëó ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô</option>
                                                <option value="mother">üë∂ ‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å</option>
                                                <option value="home">üè† ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô</option>
                                                <option value="health">üíä ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</option>
                                            </select>
                                        </div>
                                        <div id="productManagementList" class="max-h-40 overflow-y-auto space-y-1">
                                            <!-- Product list will be populated here -->
                                        </div>
                                    </div>

                                    <!-- Smart Link Product Generator -->
                                    <div class="p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-200">
                                        <h4 class="text-sm font-semibold mb-2 text-purple-800">üîó ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Ñ‡πå (Smart)</h4>
                                        <div class="space-y-2">
                                            <input type="url" id="smartProductLink" placeholder="‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Ñ‡πå Shopee, Lazada ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ" class="w-full px-2 py-1 border border-purple-300 rounded text-xs focus:ring-2 focus:ring-purple-500">
                                            <select id="smartProductCategory" class="w-full px-2 py-1 border border-purple-300 rounded text-xs focus:ring-2 focus:ring-purple-500">
                                                <option value="">ü§ñ ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</option>
                                                <option value="mobile">üì± ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</option>
                                                <option value="computer">üíª ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</option>
                                                <option value="fashion">üëó ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô</option>
                                                <option value="mother">üë∂ ‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å</option>
                                                <option value="home">üè† ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô</option>
                                                <option value="health">üíä ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</option>
                                            </select>
                                            <div class="grid grid-cols-2 gap-2">
                                                <button id="previewProductBtn" class="bg-blue-600 text-white py-1 rounded hover:bg-blue-700 transition text-xs">
                                                    üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
                                                </button>
                                                <button id="addSmartProductBtn" class="bg-purple-600 text-white py-1 rounded hover:bg-purple-700 transition text-xs">
                                                    ‚ú® ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <!-- Preview Area -->
                                        <div id="smartProductPreview" class="mt-3 hidden">
                                            <div class="bg-white rounded-lg border border-purple-200 p-3">
                                                <h5 class="text-xs font-semibold text-purple-800 mb-2">üìã ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°:</h5>
                                                <div id="previewContent" class="text-xs">
                                                    <!-- Preview content will be inserted here -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Manual Add Product (Collapsed by default) -->
                                    <div class="p-3 bg-gray-50 rounded-lg border border-gray-200">
                                        <div class="flex justify-between items-center mb-2">
                                            <h4 class="text-sm font-semibold">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á</h4>
                                            <button id="toggleManualForm" class="text-xs text-gray-600 hover:text-gray-800">
                                                <span id="toggleIcon">‚ñº</span> ‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô
                                            </button>
                                        </div>
                                        <div id="manualProductForm" class="space-y-2 hidden">
                                            <input type="text" id="productName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" class="w-full px-2 py-1 border border-gray-300 rounded text-xs">
                                            <div class="grid grid-cols-2 gap-2">
                                                <input type="number" id="productOriginalPrice" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ï‡πá‡∏°" class="px-2 py-1 border border-gray-300 rounded text-xs" oninput="calculateDiscount()">
                                                <input type="number" id="productSalePrice" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢" class="px-2 py-1 border border-gray-300 rounded text-xs" oninput="calculateDiscount()">
                                            </div>
                                            <div class="text-center">
                                                <span id="discountDisplay" class="text-xs text-red-600 font-bold">‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î: 0%</span>
                                            </div>
                                            <select id="productCategory" class="w-full px-2 py-1 border border-gray-300 rounded text-xs">
                                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>
                                                <option value="mobile">üì± ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</option>
                                                <option value="computer">üíª ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</option>
                                                <option value="fashion">üëó ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô</option>
                                                <option value="mother">üë∂ ‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å</option>
                                                <option value="home">üè† ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô</option>
                                                <option value="health">üíä ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</option>
                                            </select>
                                            <input type="url" id="productImage" placeholder="URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û" class="w-full px-2 py-1 border border-gray-300 rounded text-xs">
                                            <input type="url" id="productAffiliate" placeholder="‡∏•‡∏¥‡∏á‡∏Ñ‡πå Affiliate" class="w-full px-2 py-1 border border-gray-300 rounded text-xs">
                                            <textarea id="productDescription" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" class="w-full px-2 py-1 border border-gray-300 rounded text-xs h-16"></textarea>
                                            <button id="addProductBtn" class="w-full bg-green-600 text-white py-1 rounded hover:bg-green-700 transition text-xs">
                                                ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Link Preview Management -->
                        <div id="adminLinkPreviewSection" class="mb-4 hidden">
                            <h4 class="text-md font-semibold mb-4">üîó Link Preview - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå</h4>
                            
                            <!-- Link Input Section -->
                            <div class="mb-6 p-4 bg-green-50 rounded-lg border border-green-200">
                                <h5 class="text-sm font-semibold mb-3 text-green-800">üìù ‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h5>
                                <div class="space-y-3">
                                    <input type="text" id="adminLinkPreviewInput" placeholder="‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå Shopee, Lazada ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏ä‡πà‡∏ô: https://shopee.co.th/product-name-i.123.456" 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-sm">
                                    <div class="flex space-x-2">
                                        <button onclick="adminGenerateLinkPreview()" class="flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition text-sm">
                                            üîç ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
                                        </button>
                                        <button onclick="adminAddFromPreview()" id="adminAddFromPreviewBtn" class="flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition text-sm" disabled>
                                            ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                                        </button>
                                    </div>
                                    <p class="text-xs text-green-600">üí° ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö: ‡∏•‡∏¥‡∏á‡∏Å‡πå Shopee, Lazada ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
                                </div>
                            </div>

                            <!-- Preview Area -->
                            <div id="adminLinkPreviewContainer" class="mb-4">
                                <!-- Link preview will be generated here -->
                            </div>

                            <!-- Recent Added Products -->
                            <div class="p-4 bg-blue-50 rounded-lg border border-blue-200">
                                <h5 class="text-sm font-semibold mb-3 text-blue-800">üì¶ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (‡∏à‡∏≤‡∏Å Link Preview)</h5>
                                <div id="recentAddedProducts" class="space-y-2 max-h-40 overflow-y-auto">
                                    <p class="text-xs text-gray-500 text-center py-4">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å Link Preview</p>
                                </div>
                            </div>
                        </div>

                        <!-- Page Management -->
                        <div id="adminPagesSection" class="mb-4 hidden">
                            <h4 class="text-md font-semibold mb-2">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</h4>
                            <div class="space-y-2">
                                <button onclick="editPage('home')" class="w-full text-left bg-gray-100 px-4 py-2 rounded-lg hover:bg-gray-200 transition">
                                    üè† ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
                                </button>
                                <button onclick="editPage('about')" class="w-full text-left bg-gray-100 px-4 py-2 rounded-lg hover:bg-gray-200 transition">
                                    ‚ÑπÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤
                                </button>
                                <button onclick="editPage('contact')" class="w-full text-left bg-gray-100 px-4 py-2 rounded-lg hover:bg-gray-200 transition">
                                    üìû ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤
                                </button>
                            </div>
                        </div>

                        <button id="logoutBtn" class="w-full bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition">
                            ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Product Detail Modal -->
    <div id="productDetailModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                        <button id="closeProductDetailModal" class="text-gray-500 hover:text-gray-700">‚úï</button>
                    </div>
                    <div id="productDetailContent">
                        <!-- Product details will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Product Modal -->
    <div id="editProductModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-md w-full">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                        <button id="closeEditModal" class="text-gray-500 hover:text-gray-700">‚úï</button>
                    </div>
                    <div class="space-y-4">
                        <input type="hidden" id="editProductId">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                            <input type="text" id="editProductName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ï‡πá‡∏°</label>
                                <input type="number" id="editProductOriginalPrice" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" oninput="calculateEditDiscount()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢</label>
                                <input type="number" id="editProductSalePrice" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" oninput="calculateEditDiscount()">
                            </div>
                        </div>
                        <div class="text-center">
                            <span id="editDiscountDisplay" class="text-sm text-red-600 font-bold">‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î: 0%</span>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                            <select id="editProductCategory" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="mobile">üì± ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</option>
                                <option value="computer">üíª ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</option>
                                <option value="fashion">üëó ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô</option>
                                <option value="mother">üë∂ ‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å</option>
                                <option value="home">üè† ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô</option>
                                <option value="health">üíä ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</label>
                            <input type="url" id="editProductImage" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏•‡∏¥‡∏á‡∏Ñ‡πå Affiliate</label>
                            <input type="url" id="editProductAffiliate" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                            <textarea id="editProductDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                        <div class="flex space-x-4">
                            <button id="saveEditBtn" class="flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition">
                                üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                            </button>
                            <button id="cancelEditBtn" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition">
                                ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12 mt-16">
        <div class="max-w-7xl mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4">üõçÔ∏è Flash Sale Thailand</h3>
                    <p class="text-gray-300 mb-4">‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå Flash Sale ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ iPhone Samsung ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå MacBook ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô ‡πÄ‡∏Å‡∏° ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏ó‡∏¢</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-300 hover:text-white transition">üìò</a>
                        <a href="#" class="text-gray-300 hover:text-white transition">üì∑</a>
                        <a href="#" class="text-gray-300 hover:text-white transition">üê¶</a>
                        <a href="#" class="text-gray-300 hover:text-white transition">üì∫</a>
                    </div>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</h4>
                    <ul class="space-y-2">
                        <li><a href="#" onclick="showPage('home')" class="text-gray-300 hover:text-white transition">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a></li>
                        <li><a href="#" onclick="showPage('products')" class="text-gray-300 hover:text-white transition">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a></li>
                        <li><a href="#" onclick="showPage('about')" class="text-gray-300 hover:text-white transition">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</a></li>
                        <li><a href="#" onclick="showPage('contact')" class="text-gray-300 hover:text-white transition">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h4>
                    <ul class="space-y-2">
                        <li><a href="#" onclick="showPage('products'); filterByCategory('mobile')" class="text-gray-300 hover:text-white transition">üì± ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</a></li>
                        <li><a href="#" onclick="showPage('products'); filterByCategory('computer')" class="text-gray-300 hover:text-white transition">üíª ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</a></li>
                        <li><a href="#" onclick="showPage('products'); filterByCategory('fashion')" class="text-gray-300 hover:text-white transition">üëó ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô</a></li>
                        <li><a href="#" onclick="showPage('products'); filterByCategory('mother')" class="text-gray-300 hover:text-white transition">üë∂ ‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å</a></li>
                        <li><a href="#" onclick="showPage('products'); filterByCategory('home')" class="text-gray-300 hover:text-white transition">üè† ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô</a></li>
                        <li><a href="#" onclick="showPage('products'); filterByCategory('health')" class="text-gray-300 hover:text-white transition">üíä ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h4>
                    <ul class="space-y-2 text-gray-300">
                        <li>üìç 123 ‡∏ñ‡∏ô‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ ‡πÅ‡∏Ç‡∏ß‡∏á‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°</li>
                        <li>üìû 02-123-4567</li>
                        <li>üìß info@flashsale.com</li>
                        <li>üïí ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå-‡∏®‡∏∏‡∏Å‡∏£‡πå 9:00-18:00 ‡∏ô.</li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center">
                <p class="text-gray-300">&copy; 2024 Flash Sale. ‡∏™‡∏á‡∏ß‡∏ô‡∏•‡∏¥‡∏Ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î.</p>
            </div>
        </div>
    </footer>

    <script>
        // Firebase Configuration - ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢ config ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
        const firebaseConfig = {
            // ‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å Firebase Console
            apiKey: "AIzaSyAmsiJelUN1V8C9mCC1Osy-uSZAuk3M7Lw",
  authDomain: "test-95403.firebaseapp.com",
  databaseURL: "https://test-95403-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "test-95403",
  storageBucket: "test-95403.firebasestorage.app",
  messagingSenderId: "30370027223",
  appId: "1:30370027223:web:be434cdf70770ea44f4292",
        };

        // Initialize Firebase
        let db, auth;
        let cart = [];
        let currentUser = null;
        let allProducts = []; // ‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å Firebase

        let currentPage = 'home';
        let currentCategory = 'all';
        let filteredProducts = [];

        // Product templates for auto generation
        const productTemplates = {
            mobile: [
                { name: 'iPhone 15 Pro Max', originalPrice: 45900, salePrice: 39900, image: 'https://images.unsplash.com/photo-1592750475338-74b7b21085ab?w=400', description: '‡∏™‡∏°‡∏≤‡∏£‡πå‡∏ó‡πÇ‡∏ü‡∏ô‡∏£‡∏∏‡πà‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å Apple ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ä‡∏¥‡∏õ A17 Pro ‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡πâ‡∏≠‡∏á 48MP' },
                { name: 'Samsung Galaxy S24 Ultra', originalPrice: 42900, salePrice: 35900, image: 'https://images.unsplash.com/photo-1610945265064-0e34e5519bbf?w=400', description: '‡∏™‡∏°‡∏≤‡∏£‡πå‡∏ó‡πÇ‡∏ü‡∏ô‡πÄ‡∏£‡∏∑‡∏≠‡∏ò‡∏á‡∏à‡∏≤‡∏Å Samsung ‡∏û‡∏£‡πâ‡∏≠‡∏° S Pen ‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡πâ‡∏≠‡∏á 200MP' },
                { name: 'Google Pixel 8 Pro', originalPrice: 32900, salePrice: 27900, image: 'https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=400', description: '‡∏™‡∏°‡∏≤‡∏£‡πå‡∏ó‡πÇ‡∏ü‡∏ô AI ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å Google ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á' },
                { name: 'OnePlus 12', originalPrice: 28900, salePrice: 24900, image: 'https://images.unsplash.com/photo-1598300042247-d088f8ab3a91?w=400', description: '‡∏™‡∏°‡∏≤‡∏£‡πå‡∏ó‡πÇ‡∏ü‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏° ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ä‡∏≤‡∏£‡πå‡∏à‡πÄ‡∏£‡πá‡∏ß 100W' },
                { name: 'Xiaomi 14 Ultra', originalPrice: 35900, salePrice: 29900, image: 'https://images.unsplash.com/photo-1574944985070-8f3ebc6b79d2?w=400', description: '‡∏™‡∏°‡∏≤‡∏£‡πå‡∏ó‡πÇ‡∏ü‡∏ô‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÄ‡∏ó‡∏û ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏•‡∏ô‡∏™‡πå Leica' }
            ],
            computer: [
                { name: 'MacBook Pro M3', originalPrice: 65900, salePrice: 59900, image: 'https://images.unsplash.com/photo-1541807084-5c52b6b3adef?w=400', description: '‡πÅ‡∏•‡πá‡∏õ‡∏ó‡πá‡∏≠‡∏õ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ä‡∏¥‡∏õ M3 ‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ Retina' },
                { name: 'Dell XPS 13', originalPrice: 45900, salePrice: 39900, image: 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400', description: '‡∏≠‡∏±‡∏•‡∏ï‡∏£‡∏≤‡∏ö‡∏∏‡πä‡∏Ñ‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏° ‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡∏ö‡∏≤‡∏á ‡πÄ‡∏ö‡∏≤ ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á' },
                { name: 'ASUS ROG Strix G15', originalPrice: 55900, salePrice: 49900, image: 'https://images.unsplash.com/photo-1603302576837-37561b2e2302?w=400', description: '‡πÄ‡∏Å‡∏°‡∏°‡∏¥‡πà‡∏á‡πÅ‡∏•‡πá‡∏õ‡∏ó‡πá‡∏≠‡∏õ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏à‡∏≠ RTX 4060' },
                { name: 'HP Spectre x360', originalPrice: 42900, salePrice: 36900, image: 'https://images.unsplash.com/photo-1588872657578-7efd1f1555ed?w=400', description: '‡πÅ‡∏•‡πá‡∏õ‡∏ó‡πá‡∏≠‡∏õ 2-in-1 ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™ ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢' },
                { name: 'Lenovo ThinkPad X1', originalPrice: 48900, salePrice: 42900, image: 'https://images.unsplash.com/photo-1484788984921-03950022c9ef?w=400', description: '‡πÅ‡∏•‡πá‡∏õ‡∏ó‡πá‡∏≠‡∏õ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢' }
            ],
            fashion: [
                { name: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏¢‡∏∑‡∏î‡∏Ñ‡∏≠‡∏ï‡∏ï‡∏≠‡∏ô 100%', originalPrice: 590, salePrice: 490, image: 'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=400', description: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏¢‡∏∑‡∏î‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏î‡∏µ ‡∏ú‡πâ‡∏≤‡∏Ñ‡∏≠‡∏ï‡∏ï‡∏≠‡∏ô 100% ‡∏ô‡∏¥‡πà‡∏° ‡πÉ‡∏™‡πà‡∏™‡∏ö‡∏≤‡∏¢' },
                { name: '‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á‡∏¢‡∏µ‡∏ô‡∏™‡πå Slim Fit', originalPrice: 1290, salePrice: 990, image: 'https://images.unsplash.com/photo-1542272604-787c3835535d?w=400', description: '‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á‡∏¢‡∏µ‡∏ô‡∏™‡πå‡∏ó‡∏£‡∏á‡∏™‡∏•‡∏¥‡∏° ‡∏ú‡πâ‡∏≤‡∏î‡∏µ ‡πÉ‡∏™‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π‡∏î‡∏µ' },
                { name: '‡πÄ‡∏î‡∏£‡∏™‡∏•‡∏≥‡∏•‡∏≠‡∏á', originalPrice: 890, salePrice: 690, image: 'https://images.unsplash.com/photo-1515372039744-b8f02a3ae446?w=400', description: '‡πÄ‡∏î‡∏£‡∏™‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ ‡πÉ‡∏™‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡πÇ‡∏≠‡∏Å‡∏≤‡∏™' },
                { name: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡πÄ‡∏ä‡∏¥‡πâ‡∏ï‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢', originalPrice: 790, salePrice: 590, image: 'https://images.unsplash.com/photo-1602810318383-e386cc2a3ccf?w=400', description: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡πÄ‡∏ä‡∏¥‡πâ‡∏ï‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡∏ú‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏¢‡∏±‡∏ö ‡∏£‡∏µ‡∏î‡∏á‡πà‡∏≤‡∏¢' },
                { name: '‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏ú‡πâ‡∏≤‡πÉ‡∏ö', originalPrice: 1590, salePrice: 1290, image: 'https://images.unsplash.com/photo-1549298916-b41d501d3772?w=400', description: '‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏ú‡πâ‡∏≤‡πÉ‡∏ö‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô ‡πÉ‡∏™‡πà‡∏™‡∏ö‡∏≤‡∏¢ ‡πÄ‡∏î‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô' }
            ],
            mother: [
                { name: '‡∏ú‡πâ‡∏≤‡∏≠‡πâ‡∏≠‡∏°‡πÄ‡∏î‡πá‡∏Å Premium', originalPrice: 890, salePrice: 690, image: 'https://images.unsplash.com/photo-1515488042361-ee00e0ddd4e4?w=400', description: '‡∏ú‡πâ‡∏≤‡∏≠‡πâ‡∏≠‡∏°‡πÄ‡∏î‡πá‡∏Å‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á ‡∏ô‡∏∏‡πà‡∏° ‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô ‡πÑ‡∏°‡πà‡∏£‡∏±‡πà‡∏ß‡∏ã‡∏∂‡∏°' },
                { name: '‡∏ô‡∏°‡∏ú‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏î‡πá‡∏Å', originalPrice: 1290, salePrice: 1090, image: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400', description: '‡∏ô‡∏°‡∏ú‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏î‡πá‡∏Å ‡∏™‡∏π‡∏ï‡∏£‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£' },
                { name: '‡∏£‡∏ñ‡πÄ‡∏Ç‡πá‡∏ô‡πÄ‡∏î‡πá‡∏Å 3 ‡∏•‡πâ‡∏≠', originalPrice: 4590, salePrice: 3990, image: 'https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=400', description: '‡∏£‡∏ñ‡πÄ‡∏Ç‡πá‡∏ô‡πÄ‡∏î‡πá‡∏Å‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡∏û‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏î‡πâ ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏ö‡∏≤' },
                { name: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡πÄ‡∏î‡πá‡∏Å Cotton', originalPrice: 390, salePrice: 290, image: 'https://images.unsplash.com/photo-1522771930-78848d9293e8?w=400', description: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡πÄ‡∏î‡πá‡∏Å‡∏ú‡πâ‡∏≤‡∏Ñ‡∏≠‡∏ï‡∏ï‡∏≠‡∏ô ‡∏ô‡∏∏‡πà‡∏° ‡πÉ‡∏™‡πà‡∏™‡∏ö‡∏≤‡∏¢ ‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏Ñ‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏∑‡∏≠‡∏á' },
                { name: '‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£', originalPrice: 690, salePrice: 490, image: 'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400', description: '‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡πá‡∏Å ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ' }
            ],
            home: [
                { name: '‡∏ï‡πâ‡∏ô‡πÑ‡∏ú‡πà‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏ñ‡∏≤‡∏á', originalPrice: 1200, salePrice: 990, image: 'https://images.unsplash.com/photo-1416879595882-3373a0480b5b?w=400', description: '‡∏ï‡πâ‡∏ô‡πÑ‡∏ú‡πà‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏ö‡πâ‡∏≤‡∏ô' },
                { name: '‡πÇ‡∏Ñ‡∏°‡πÑ‡∏ü‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏ï‡πä‡∏∞ LED', originalPrice: 890, salePrice: 690, image: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400', description: '‡πÇ‡∏Ñ‡∏°‡πÑ‡∏ü LED ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡πÑ‡∏ü ‡πÅ‡∏™‡∏á‡∏ô‡∏¥‡πà‡∏°‡∏ï‡∏≤' },
                { name: '‡∏´‡∏°‡∏≠‡∏ô‡∏≠‡∏¥‡∏á Sofa', originalPrice: 450, salePrice: 350, image: 'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400', description: '‡∏´‡∏°‡∏≠‡∏ô‡∏≠‡∏¥‡∏á‡∏ô‡∏∏‡πà‡∏°‡∏™‡∏ö‡∏≤‡∏¢ ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡πÇ‡∏ã‡∏ü‡∏≤' },
                { name: '‡∏ú‡πâ‡∏≤‡∏õ‡∏π‡∏ó‡∏µ‡πà‡∏ô‡∏≠‡∏ô Cotton', originalPrice: 1290, salePrice: 990, image: 'https://images.unsplash.com/photo-1631049307264-da0ec9d70304?w=400', description: '‡∏ú‡πâ‡∏≤‡∏õ‡∏π‡∏ó‡∏µ‡πà‡∏ô‡∏≠‡∏ô‡∏Ñ‡∏≠‡∏ï‡∏ï‡∏≠‡∏ô ‡∏ô‡∏∏‡πà‡∏° ‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏î‡∏µ' },
                { name: '‡∏Å‡∏£‡∏∞‡∏ñ‡∏≤‡∏á‡∏î‡∏¥‡∏ô‡πÄ‡∏ú‡∏≤', originalPrice: 320, salePrice: 250, image: 'https://images.unsplash.com/photo-1485955900006-10f4d324d411?w=400', description: '‡∏Å‡∏£‡∏∞‡∏ñ‡∏≤‡∏á‡∏î‡∏¥‡∏ô‡πÄ‡∏ú‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏•‡∏π‡∏Å‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ' }
            ],
            health: [
                { name: '‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡∏ã‡∏µ 1000mg', originalPrice: 450, salePrice: 350, image: 'https://images.unsplash.com/photo-1584308666744-24d5c474f2ae?w=400', description: '‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡∏ã‡∏µ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô ‡∏ö‡∏£‡∏£‡∏à‡∏∏ 60 ‡πÄ‡∏°‡πá‡∏î' },
                { name: '‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô‡πÄ‡∏ß‡∏¢‡πå', originalPrice: 1890, salePrice: 1590, image: 'https://images.unsplash.com/photo-1593095948071-474c5cc2989d?w=400', description: '‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô‡πÄ‡∏ß‡∏¢‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢ ‡∏£‡∏™‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï' },
                { name: '‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏õ‡∏•‡∏≤ Omega-3', originalPrice: 690, salePrice: 490, image: 'https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400', description: '‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏õ‡∏•‡∏≤‡∏ö‡∏£‡∏¥‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå ‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏™‡∏°‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏ß‡πÉ‡∏à' },
                { name: '‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡∏£‡∏ß‡∏°', originalPrice: 590, salePrice: 450, image: 'https://images.unsplash.com/photo-1550572017-edd951aa8f72?w=400', description: '‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡∏£‡∏ß‡∏°‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û' },
                { name: '‡∏Ñ‡∏≠‡∏•‡∏•‡∏≤‡πÄ‡∏à‡∏ô', originalPrice: 1290, salePrice: 990, image: 'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=400', description: '‡∏Ñ‡∏≠‡∏•‡∏•‡∏≤‡πÄ‡∏à‡∏ô‡∏ö‡∏£‡∏¥‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå ‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏ú‡∏¥‡∏ß‡∏û‡∏£‡∏£‡∏ì' }
            ]
        };

        // Calculate discount percentage
        function calculateDiscount() {
            const originalPrice = parseFloat(document.getElementById('productOriginalPrice').value) || 0;
            const salePrice = parseFloat(document.getElementById('productSalePrice').value) || 0;
            
            if (originalPrice > 0 && salePrice > 0 && salePrice < originalPrice) {
                const discount = Math.round(((originalPrice - salePrice) / originalPrice) * 100);
                document.getElementById('discountDisplay').textContent = `‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î: ${discount}%`;
                document.getElementById('discountDisplay').className = 'text-xs text-red-600 font-bold';
            } else if (originalPrice > 0 && salePrice >= originalPrice) {
                document.getElementById('discountDisplay').textContent = '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ï‡πá‡∏°';
                document.getElementById('discountDisplay').className = 'text-xs text-orange-600 font-bold';
            } else {
                document.getElementById('discountDisplay').textContent = '‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î: 0%';
                document.getElementById('discountDisplay').className = 'text-xs text-gray-500 font-bold';
            }
        }

        // Calculate discount for edit form
        function calculateEditDiscount() {
            const originalPrice = parseFloat(document.getElementById('editProductOriginalPrice').value) || 0;
            const salePrice = parseFloat(document.getElementById('editProductSalePrice').value) || 0;
            
            if (originalPrice > 0 && salePrice > 0 && salePrice < originalPrice) {
                const discount = Math.round(((originalPrice - salePrice) / originalPrice) * 100);
                document.getElementById('editDiscountDisplay').textContent = `‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î: ${discount}%`;
                document.getElementById('editDiscountDisplay').className = 'text-sm text-red-600 font-bold';
            } else if (originalPrice > 0 && salePrice >= originalPrice) {
                document.getElementById('editDiscountDisplay').textContent = '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ï‡πá‡∏°';
                document.getElementById('editDiscountDisplay').className = 'text-sm text-orange-600 font-bold';
            } else {
                document.getElementById('editDiscountDisplay').textContent = '‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î: 0%';
                document.getElementById('editDiscountDisplay').className = 'text-sm text-gray-500 font-bold';
            }
        }

        // Calculate discount percentage for display
        function getDiscountPercentage(originalPrice, salePrice) {
            if (originalPrice > 0 && salePrice > 0 && salePrice < originalPrice) {
                return Math.round(((originalPrice - salePrice) / originalPrice) * 100);
            }
            return 0;
        }

        // Initialize app
        function initApp() {
            try {
                // Initialize Firebase
                firebase.initializeApp(firebaseConfig);
                db = firebase.firestore();
                auth = firebase.auth();
                
                console.log('Firebase initialized successfully');
                
                // Monitor auth state
                auth.onAuthStateChanged((user) => {
                    if (user) {
                        currentUser = user;
                        console.log('User signed in:', user.email);
                        updateAdminUI(true);
                        updateProductStats(); // Update stats when admin logs in
                    } else {
                        currentUser = null;
                        console.log('User signed out');
                        updateAdminUI(false);
                    }
                });
                
                // Load products from Firestore
                loadProductsFromFirestore();
                
                // Initialize with sample data if no products exist
                initializeSampleData();
                
            } catch (error) {
                console.error('Firebase initialization error:', error);
                showNotification('‡πÉ‡∏ä‡πâ‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå - ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Firebase Config ‚ö†Ô∏è', 'error');
                
                // Fallback to demo data
                initializeDemoData();
            }
        }

        // Initialize sample data for first time setup
        async function initializeSampleData() {
            try {
                const snapshot = await db.collection('products').limit(1).get();
                
                if (snapshot.empty) {
                    console.log('No products found, adding sample data...');
                    
                    const sampleProducts = [
                        {
                            name: 'iPhone 15 Pro',
                            price: 39900,
                            category: 'mobile',
                            image: 'https://images.unsplash.com/photo-1592750475338-74b7b21085ab?w=400',
                            description: '‡∏™‡∏°‡∏≤‡∏£‡πå‡∏ó‡πÇ‡∏ü‡∏ô‡∏£‡∏∏‡πà‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å Apple ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ä‡∏¥‡∏õ A17 Pro',
                            affiliateLink: 'https://shopee.co.th/iphone-15-pro',
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        },
                        {
                            name: 'MacBook Air M2',
                            price: 42900,
                            category: 'computer',
                            image: 'https://images.unsplash.com/photo-1541807084-5c52b6b3adef?w=400',
                            description: '‡πÅ‡∏•‡πá‡∏õ‡∏ó‡πá‡∏≠‡∏õ‡∏ó‡∏µ‡πà‡∏ö‡∏≤‡∏á‡πÄ‡∏ö‡∏≤‡πÅ‡∏•‡∏∞‡∏ó‡∏£‡∏á‡∏û‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å Apple',
                            affiliateLink: 'https://lazada.co.th/macbook-air-m2',
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        },
                        {
                            name: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏¢‡∏∑‡∏î‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô',
                            price: 590,
                            category: 'fashion',
                            image: 'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=400',
                            description: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏¢‡∏∑‡∏î‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏î‡∏µ ‡∏ú‡πâ‡∏≤‡∏ô‡∏¥‡πà‡∏° ‡πÉ‡∏™‡πà‡∏™‡∏ö‡∏≤‡∏¢',
                            affiliateLink: 'https://shopee.co.th/fashion-tshirt',
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        },
                        {
                            name: '‡∏ï‡πâ‡∏ô‡πÑ‡∏ú‡πà‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏ñ‡∏≤‡∏á',
                            price: 1200,
                            category: 'home',
                            image: 'https://images.unsplash.com/photo-1416879595882-3373a0480b5b?w=400',
                            description: '‡∏ï‡πâ‡∏ô‡πÑ‡∏ú‡πà‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô',
                            affiliateLink: 'https://lazada.co.th/bamboo-plant',
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        },
                        {
                            name: 'PlayStation 5',
                            price: 18900,
                            category: 'game',
                            image: 'https://images.unsplash.com/photo-1606144042614-b2417e99c4e3?w=400',
                            description: '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Å‡∏°‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏ã‡∏•‡∏£‡∏∏‡πà‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å Sony',
                            affiliateLink: 'https://shopee.co.th/playstation-5',
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        },
                        {
                            name: '‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡∏ã‡∏µ 1000mg',
                            price: 450,
                            category: 'health',
                            image: 'https://images.unsplash.com/photo-1584308666744-24d5c474f2ae?w=400',
                            description: '‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡∏ã‡∏µ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô ‡∏ö‡∏£‡∏£‡∏à‡∏∏ 60 ‡πÄ‡∏°‡πá‡∏î',
                            affiliateLink: 'https://lazada.co.th/vitamin-c',
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        }
                    ];

                    // Add sample products to Firestore
                    const batch = db.batch();
                    sampleProducts.forEach(product => {
                        const docRef = db.collection('products').doc();
                        batch.set(docRef, product);
                    });
                    
                    await batch.commit();
                    console.log('Sample products added successfully');
                    showNotification('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢! üéâ');
                    
                    // Reload products
                    loadProductsFromFirestore();
                }
            } catch (error) {
                console.error('Error initializing sample data:', error);
            }
        }

        // Initialize demo data as fallback
        function initializeDemoData() {
            allProducts = [
                {
                    id: '1',
                    name: 'iPhone 15 Pro',
                    price: 39900,
                    category: 'mobile',
                    image: 'https://images.unsplash.com/photo-1592750475338-74b7b21085ab?w=400',
                    description: '‡∏™‡∏°‡∏≤‡∏£‡πå‡∏ó‡πÇ‡∏ü‡∏ô‡∏£‡∏∏‡πà‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å Apple ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ä‡∏¥‡∏õ A17 Pro',
                    affiliateLink: 'https://shopee.co.th/iphone-15-pro'
                },
                {
                    id: '2',
                    name: 'MacBook Air M2',
                    price: 42900,
                    category: 'computer',
                    image: 'https://images.unsplash.com/photo-1541807084-5c52b6b3adef?w=400',
                    description: '‡πÅ‡∏•‡πá‡∏õ‡∏ó‡πá‡∏≠‡∏õ‡∏ó‡∏µ‡πà‡∏ö‡∏≤‡∏á‡πÄ‡∏ö‡∏≤‡πÅ‡∏•‡∏∞‡∏ó‡∏£‡∏á‡∏û‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å Apple',
                    affiliateLink: 'https://lazada.co.th/macbook-air-m2'
                }
            ];
            
            filteredProducts = [...allProducts];
            loadProducts();
            loadHomePageProducts();
        }

        // Load products from Firestore
        async function loadProductsFromFirestore() {
            if (!db) {
                console.log('Firestore not initialized, using demo data');
                initializeDemoData();
                return;
            }

            try {
                document.getElementById('loadingSpinner').classList.remove('hidden');
                document.getElementById('productsGrid').classList.add('hidden');
                
                console.log('Loading products from Firestore...');
                const snapshot = await db.collection('products').orderBy('createdAt', 'desc').get();
                
                allProducts = [];
                snapshot.forEach(doc => {
                    const data = doc.data();
                    allProducts.push({
                        id: doc.id,
                        name: data.name || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠',
                        price: data.price || 0,
                        category: data.category || 'other',
                        image: data.image || 'https://via.placeholder.com/400x300?text=No+Image',
                        description: data.description || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î',
                        affiliateLink: data.affiliateLink || null,
                        createdAt: data.createdAt
                    });
                });
                
                console.log(`‚úÖ Loaded ${allProducts.length} products from Firestore`);
                
                if (allProducts.length === 0) {
                    console.log('No products found, will initialize sample data');
                }
                
                filteredProducts = [...allProducts];
                loadProducts();
                loadHomePageProducts();
                
            } catch (error) {
                console.error('‚ùå Error loading products:', error);
                console.log('Falling back to demo data');
                showNotification('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‚ö†Ô∏è', 'error');
                
                // Fallback to demo data
                initializeDemoData();
            }
        }

        // Load products for home page
        function loadHomePageProducts() {
            const categories = ['mobile', 'computer', 'fashion', 'home', 'game', 'health'];
            
            categories.forEach(category => {
                const categoryProducts = allProducts.filter(product => product.category === category).slice(0, 3);
                const containerId = category + 'Products';
                const container = document.getElementById(containerId);
                
                if (container && categoryProducts.length > 0) {
                    container.innerHTML = categoryProducts.map(product => {
                        const originalPrice = product.originalPrice || product.price || 0;
                        const salePrice = product.salePrice || product.price || 0;
                        const discount = getDiscountPercentage(originalPrice, salePrice);
                        return `
                        <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition cursor-pointer relative" onclick="showProductDetail('${product.id}')">
                            ${discount > 0 ? `
                                <div class="absolute top-2 left-2 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold">
                                    -${discount}%
                                </div>
                            ` : ''}
                            <img src="${product.image}" alt="${product.name}" class="w-full h-32 object-cover">
                            <div class="p-4">
                                <h4 class="font-semibold text-sm mb-2">${product.name}</h4>
                                <p class="text-xs text-gray-600 mb-2">${product.description.substring(0, 50)}...</p>
                                <div class="flex justify-between items-center mb-3">
                                    <div>
                                        <span class="text-lg font-bold text-red-600">‡∏ø${salePrice.toLocaleString()}</span>
                                        ${discount > 0 ? `
                                            <span class="text-xs text-gray-500 line-through ml-1">‡∏ø${originalPrice.toLocaleString()}</span>
                                        ` : ''}
                                    </div>
                                </div>
                                <div class="flex space-x-2" onclick="event.stopPropagation()">
                                    <button onclick="addToCart('${product.id}')" class="flex-1 bg-red-600 text-white px-3 py-1 rounded text-xs hover:bg-red-700 transition">
                                        ‚ö° ‡πÄ‡∏û‡∏¥‡πà‡∏°
                                    </button>
                                    ${product.affiliateLink ? `
                                        <a href="${product.affiliateLink}" target="_blank" class="flex-1 bg-orange-600 text-white px-3 py-1 rounded text-xs hover:bg-orange-700 transition text-center">
                                            üõçÔ∏è ‡∏ã‡∏∑‡πâ‡∏≠
                                        </a>
                                    ` : ''}
                                </div>
                            </div>
                        </div>
                    `;}).join('');
                } else if (container) {
                    container.innerHTML = '<p class="text-gray-500 text-center py-8">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏ô‡∏µ‡πâ</p>';
                }
            });
        }

        // Load products with loading state
        function loadProducts() {
            setTimeout(() => {
                document.getElementById('loadingSpinner').classList.add('hidden');
                document.getElementById('productsGrid').classList.remove('hidden');
                displayProducts(filteredProducts);
            }, 500);
        }

        // Show page function
        function showPage(page) {
            // Hide all pages
            document.getElementById('heroSection').style.display = page === 'home' ? 'block' : 'none';
            document.getElementById('homePage').style.display = page === 'home' ? 'block' : 'none';
            document.getElementById('productsPage').style.display = page === 'products' ? 'block' : 'none';
            document.getElementById('aboutPage').style.display = page === 'about' ? 'block' : 'none';
            document.getElementById('contactPage').style.display = page === 'contact' ? 'block' : 'none';
            document.getElementById('flashSalePage').style.display = page === 'flashsale' ? 'block' : 'none';
            document.getElementById('promotionPage').style.display = page === 'promotion' ? 'block' : 'none';
            
            currentPage = page;
            
            // Update breadcrumb
            updateBreadcrumb(page);
            
            // Update page title for SEO
            updatePageTitle(page);
            
            // Load products if showing products page
            if (page === 'products') {
                loadProducts();
            }
        }

        // Update breadcrumb navigation
        function updateBreadcrumb(page) {
            const breadcrumb = document.getElementById('breadcrumb');
            const breadcrumbCurrent = document.getElementById('breadcrumbCurrent');
            
            const pageNames = {
                'home': '‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å',
                'products': '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',
                'about': '‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤',
                'contact': '‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤',
                'flashsale': 'Flash Sale',
                'promotion': '‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô'
            };
            
            if (page === 'home') {
                breadcrumb.classList.add('hidden');
            } else {
                breadcrumb.classList.remove('hidden');
                breadcrumbCurrent.textContent = pageNames[page] || page;
            }
        }

        // Update page title for SEO
        function updatePageTitle(page) {
            const titles = {
                'home': 'Flash Sale ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå | ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô',
                'products': '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î Flash Sale ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤ | ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô',
                'about': '‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤ Flash Sale Thailand | ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ä‡∏±‡πâ‡∏ô‡∏ô‡∏≥',
                'contact': '‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤ Flash Sale Thailand | ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á',
                'flashsale': 'Flash Sale ‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% | ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û',
                'promotion': '‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© Flash Sale | ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà'
            };
            
            document.title = titles[page] || 'Flash Sale Thailand';
            
            // Update meta description for each page
            updateMetaDescription(page);
        }

        // Update meta description for SEO
        function updateMetaDescription(page) {
            const descriptions = {
                'home': '‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå Flash Sale ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ iPhone Samsung ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå MacBook ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô ‡πÄ‡∏Å‡∏° ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏ó‡∏¢',
                'products': '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î Flash Sale ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ iPhone Samsung ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå MacBook ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô ‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤ ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô ‡πÄ‡∏Å‡∏° ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô',
                'about': '‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö Flash Sale Thailand ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ä‡∏±‡πâ‡∏ô‡∏ô‡∏≥ ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏ó‡∏¢ ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á',
                'contact': '‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ Flash Sale Thailand ‡πÇ‡∏ó‡∏£ 02-123-4567 ‡∏≠‡∏µ‡πÄ‡∏°‡∏• info@flashsale.com ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå-‡∏®‡∏∏‡∏Å‡∏£‡πå 9:00-18:00 ‡∏ô.',
                'flashsale': 'Flash Sale ‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 70% ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô ‡πÄ‡∏Å‡∏° ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≥‡∏Å‡∏±‡∏î',
                'promotion': '‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© Flash Sale ‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ iPhone Samsung ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå MacBook ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô ‡πÄ‡∏Å‡∏° ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û'
            };
            
            let metaDesc = document.querySelector('meta[name="description"]');
            if (metaDesc) {
                metaDesc.setAttribute('content', descriptions[page] || descriptions['home']);
            }
        }

        // Generate sitemap for SEO
        function generateSitemap() {
            const baseUrl = 'https://flashsale-thailand.com';
            const pages = [
                { url: '/', priority: '1.0', changefreq: 'daily' },
                { url: '/products', priority: '0.9', changefreq: 'daily' },
                { url: '/about', priority: '0.7', changefreq: 'monthly' },
                { url: '/contact', priority: '0.6', changefreq: 'monthly' },
                { url: '/flash-sale', priority: '0.9', changefreq: 'hourly' },
                { url: '/promotion', priority: '0.8', changefreq: 'daily' }
            ];
            
            let sitemap = '<?xml version="1.0" encoding="UTF-8"?>\n';
            sitemap += '<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">\n';
            
            pages.forEach(page => {
                sitemap += `  <url>\n`;
                sitemap += `    <loc>${baseUrl}${page.url}</loc>\n`;
                sitemap += `    <lastmod>${new Date().toISOString().split('T')[0]}</lastmod>\n`;
                sitemap += `    <changefreq>${page.changefreq}</changefreq>\n`;
                sitemap += `    <priority>${page.priority}</priority>\n`;
                sitemap += `  </url>\n`;
            });
            
            // Add product pages
            allProducts.forEach(product => {
                sitemap += `  <url>\n`;
                sitemap += `    <loc>${baseUrl}/product/${product.id}</loc>\n`;
                sitemap += `    <lastmod>${new Date().toISOString().split('T')[0]}</lastmod>\n`;
                sitemap += `    <changefreq>weekly</changefreq>\n`;
                sitemap += `    <priority>0.8</priority>\n`;
                sitemap += `  </url>\n`;
            });
            
            sitemap += '</urlset>';
            
            return sitemap;
        }

        // Add structured data for products
        function addProductStructuredData(product) {
            const structuredData = {
                "@context": "https://schema.org/",
                "@type": "Product",
                "name": product.name,
                "image": product.image,
                "description": product.description,
                "brand": {
                    "@type": "Brand",
                    "name": "Flash Sale Thailand"
                },
                "offers": {
                    "@type": "Offer",
                    "url": `https://flashsale-thailand.com/product/${product.id}`,
                    "priceCurrency": "THB",
                    "price": product.price,
                    "availability": "https://schema.org/InStock",
                    "seller": {
                        "@type": "Organization",
                        "name": "Flash Sale Thailand"
                    }
                },
                "aggregateRating": {
                    "@type": "AggregateRating",
                    "ratingValue": "4.5",
                    "reviewCount": "127"
                }
            };
            
            // Remove existing product structured data
            const existingScript = document.querySelector('script[data-product-structured-data]');
            if (existingScript) {
                existingScript.remove();
            }
            
            // Add new structured data
            const script = document.createElement('script');
            script.type = 'application/ld+json';
            script.setAttribute('data-product-structured-data', 'true');
            script.textContent = JSON.stringify(structuredData);
            document.head.appendChild(script);
        }

        // Filter by category
        function filterByCategory(category) {
            currentCategory = category;
            
            // Update category buttons
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('category-active');
            });
            if (event && event.target) {
                event.target.classList.add('category-active');
            }
            
            // Filter products
            if (category === 'all') {
                filteredProducts = [...allProducts];
            } else {
                filteredProducts = allProducts.filter(product => product.category === category);
            }
            
            displayProducts(filteredProducts);
        }

        // Display products
        function displayProducts(products) {
            const grid = document.getElementById('productsGrid');
            
            if (products.length === 0) {
                document.getElementById('emptyState').classList.remove('hidden');
                grid.classList.add('hidden');
                return;
            }

            grid.innerHTML = products.map(product => {
                const originalPrice = product.originalPrice || product.price || 0;
                const salePrice = product.salePrice || product.price || 0;
                const discount = getDiscountPercentage(originalPrice, salePrice);
                return `
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition fade-in cursor-pointer relative" onclick="showProductDetail('${product.id}')">
                    ${discount > 0 ? `
                        <div class="absolute top-2 left-2 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold">
                            -${discount}%
                        </div>
                    ` : ''}
                    <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover">
                    <div class="p-4">
                        <h3 class="font-semibold text-lg mb-2">${product.name}</h3>
                        <p class="text-gray-600 text-sm mb-3">${product.description}</p>
                        <div class="flex justify-between items-center mb-3">
                            <div>
                                <span class="text-xl font-bold text-red-600">‡∏ø${salePrice.toLocaleString()}</span>
                                ${discount > 0 ? `
                                    <span class="text-sm text-gray-500 line-through ml-2">‡∏ø${originalPrice.toLocaleString()}</span>
                                ` : ''}
                            </div>
                        </div>
                        <div class="flex space-x-2" onclick="event.stopPropagation()">
                            <button onclick="addToCart('${product.id}')" class="flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition">
                                ‚ö° ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
                            </button>
                            ${product.affiliateLink ? `
                                <a href="${product.affiliateLink}" target="_blank" class="flex-1 bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition text-center">
                                    üõçÔ∏è ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏¢
                                </a>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;}).join('');
        }

        // Add to cart
        function addToCart(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (product) {
                const existingItem = cart.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    cart.push({ ...product, quantity: 1 });
                }
                updateCartUI();
                
                // Show success message
                showNotification('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß! üõí');
            }
        }

        // Update cart UI
        function updateCartUI() {
            const cartCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = cartCount;
        }

        // Show cart modal
        function showCartModal() {
            const modal = document.getElementById('cartModal');
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            const cartPurchaseButtons = document.getElementById('cartPurchaseButtons');

            if (cart.length === 0) {
                cartItems.innerHTML = '<p class="text-gray-500 text-center py-4">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á</p>';
                cartTotal.textContent = '‡∏ø0';
                cartPurchaseButtons.innerHTML = '';
            } else {
                cartItems.innerHTML = cart.map(item => `
                    <div class="flex justify-between items-center py-2 border-b">
                        <div class="flex items-center space-x-3">
                            <img src="${item.image}" alt="${item.name}" class="w-12 h-12 object-cover rounded">
                            <div>
                                <h4 class="font-medium">${item.name}</h4>
                                <p class="text-sm text-gray-500">‡∏ø${item.price.toLocaleString()} x ${item.quantity}</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button onclick="updateQuantity('${item.id}', -1)" class="bg-gray-200 px-2 py-1 rounded">-</button>
                            <span>${item.quantity}</span>
                            <button onclick="updateQuantity('${item.id}', 1)" class="bg-gray-200 px-2 py-1 rounded">+</button>
                            <button onclick="removeFromCart('${item.id}')" class="text-red-500 ml-2">üóëÔ∏è</button>
                        </div>
                    </div>
                `).join('');

                const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                cartTotal.textContent = `‡∏ø${total.toLocaleString()}`;

                // Generate purchase buttons for each item with affiliate link
                const itemsWithLinks = cart.filter(item => item.affiliateLink);
                const itemsWithoutLinks = cart.filter(item => !item.affiliateLink);

                let buttonsHTML = '';

                if (itemsWithLinks.length > 0) {
                    buttonsHTML += `
                        <div class="space-y-2">
                            <h4 class="text-sm font-medium text-gray-700 mb-2">üõçÔ∏è ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏°‡∏µ‡∏•‡∏¥‡∏á‡∏Å‡πå affiliate):</h4>
                            ${itemsWithLinks.map(item => `
                                <a href="${item.affiliateLink}" target="_blank" 
                                   class="flex items-center justify-between w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                                    <div class="flex items-center space-x-2">
                                        <img src="${item.image}" alt="${item.name}" class="w-6 h-6 object-cover rounded">
                                        <span class="text-sm">${item.name} (${item.quantity}x)</span>
                                    </div>
                                    <span class="text-sm font-bold">‡∏ø${(item.price * item.quantity).toLocaleString()}</span>
                                </a>
                            `).join('')}
                        </div>
                    `;
                }

                if (itemsWithoutLinks.length > 0) {
                    buttonsHTML += `
                        <div class="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                            <h4 class="text-sm font-medium text-yellow-800 mb-2">‚ö†Ô∏è ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠:</h4>
                            <div class="space-y-1">
                                ${itemsWithoutLinks.map(item => `
                                    <div class="flex justify-between text-sm text-yellow-700">
                                        <span>${item.name} (${item.quantity}x)</span>
                                        <span>‡∏ø${(item.price * item.quantity).toLocaleString()}</span>
                                    </div>
                                `).join('')}
                            </div>
                            <p class="text-xs text-yellow-600 mt-2">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>
                        </div>
                    `;
                }

                if (itemsWithLinks.length === 0 && itemsWithoutLinks.length > 0) {
                    buttonsHTML += `
                        <button onclick="showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ üìû', 'error')" 
                                class="w-full bg-gray-400 text-white py-2 rounded-lg mt-2 cursor-not-allowed">
                            ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ
                        </button>
                    `;
                }

                cartPurchaseButtons.innerHTML = buttonsHTML;
            }

            modal.classList.remove('hidden');
        }

        // Update quantity
        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else {
                    updateCartUI();
                    showCartModal(); // Refresh modal
                }
            }
        }

        // Remove from cart
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartUI();
            showCartModal(); // Refresh modal
        }

        // Admin login with Firebase Auth
        async function adminLogin() {
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;

            if (!email || !password) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô ‚ö†Ô∏è', 'error');
                return;
            }

            const loginBtn = document.getElementById('loginBtn');
            const originalText = loginBtn.textContent;
            loginBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...';
            loginBtn.disabled = true;

            try {
                if (auth) {
                    // Use Firebase Authentication
                    await auth.signInWithEmailAndPassword(email, password);
                    showNotification('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üë§');
                } else {
                    // Fallback demo login
                    if (email === 'admin@demo.com' && password === 'admin123') {
                        currentUser = { email: email };
                        updateAdminUI(true);
                        showNotification('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! (‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå) üë§');
                    } else {
                        throw new Error('Invalid credentials');
                    }
                }
            } catch (error) {
                console.error('Login error:', error);
                let errorMessage = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö ‚ùå';
                
                if (error.code === 'auth/user-not-found') {
                    errorMessage = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‚ùå';
                } else if (error.code === 'auth/wrong-password') {
                    errorMessage = '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‚ùå';
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage = '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‚ùå';
                } else if (error.code === 'auth/too-many-requests') {
                    errorMessage = '‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà ‚è∞';
                }
                
                showNotification(errorMessage, 'error');
            } finally {
                loginBtn.textContent = originalText;
                loginBtn.disabled = false;
            }
        }

        // Update admin UI based on auth state
        function updateAdminUI(isLoggedIn) {
            if (isLoggedIn) {
                document.getElementById('loginForm').classList.add('hidden');
                document.getElementById('adminPanel').classList.remove('hidden');
            } else {
                document.getElementById('loginForm').classList.remove('hidden');
                document.getElementById('adminPanel').classList.add('hidden');
                // Clear form
                document.getElementById('adminEmail').value = '';
                document.getElementById('adminPassword').value = '';
            }
        }

        // Show admin section
        function showAdminSection(section) {
            document.getElementById('adminProductsSection').style.display = section === 'products' ? 'block' : 'none';
            document.getElementById('adminLinkPreviewSection').style.display = section === 'linkpreview' ? 'block' : 'none';
            document.getElementById('adminPagesSection').style.display = section === 'pages' ? 'block' : 'none';
            
            // Update button styles
            document.querySelectorAll('.admin-section-btn').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'bg-green-600', 'bg-purple-600');
                btn.classList.add('bg-gray-600');
            });
            
            if (section === 'products') {
                document.getElementById('adminProductsBtn').classList.remove('bg-gray-600');
                document.getElementById('adminProductsBtn').classList.add('bg-blue-600');
            } else if (section === 'linkpreview') {
                document.getElementById('adminLinkPreviewBtn').classList.remove('bg-gray-600');
                document.getElementById('adminLinkPreviewBtn').classList.add('bg-green-600');
            } else if (section === 'pages') {
                document.getElementById('adminPagesBtn').classList.remove('bg-gray-600');
                document.getElementById('adminPagesBtn').classList.add('bg-purple-600');
            }
        }

        // Edit page function
        function editPage(page) {
            showNotification(`‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç${page === 'home' ? '‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å' : page === 'about' ? '‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤' : '‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤'}... üìù`);
            
            // Close admin modal and show the page
            document.getElementById('adminModal').classList.add('hidden');
            showPage(page);
        }

        // Generate random products automatically
        async function generateProducts() {
            const category = document.getElementById('autoCategory').value;
            const count = parseInt(document.getElementById('autoCount').value) || 5;

            if (!category) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚ö†Ô∏è', 'error');
                return;
            }

            if (count < 1 || count > 20) {
                showNotification('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 1-20 ‡∏ä‡∏¥‡πâ‡∏ô ‚ö†Ô∏è', 'error');
                return;
            }

            try {
                const generateBtn = document.getElementById('generateProductsBtn');
                const originalText = generateBtn.textContent;
                generateBtn.textContent = `‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á ${count} ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤...`;
                generateBtn.disabled = true;

                const templates = productTemplates[category];
                const affiliateLinks = {
                    mobile: ['https://shopee.co.th/mobile', 'https://lazada.co.th/mobile'],
                    computer: ['https://shopee.co.th/laptop', 'https://lazada.co.th/laptop'],
                    fashion: ['https://shopee.co.th/fashion', 'https://lazada.co.th/fashion'],
                    mother: ['https://shopee.co.th/baby-kids', 'https://lazada.co.th/baby-kids'],
                    home: ['https://shopee.co.th/home', 'https://lazada.co.th/home'],
                    health: ['https://shopee.co.th/health', 'https://lazada.co.th/health']
                };

                const batch = db ? db.batch() : null;
                const newProducts = [];

                for (let i = 0; i < count; i++) {
                    const template = templates[Math.floor(Math.random() * templates.length)];
                    const priceVariation = 0.8 + (Math.random() * 0.4); // ¬±20% price variation
                    const originalPrice = Math.round(template.originalPrice * priceVariation);
                    const salePrice = Math.round(template.salePrice * priceVariation);
                    
                    const product = {
                        name: `${template.name} ${Math.random().toString(36).substring(2, 5).toUpperCase()}`,
                        originalPrice: originalPrice,
                        salePrice: salePrice,
                        category: category,
                        image: template.image,
                        description: template.description,
                        affiliateLink: affiliateLinks[category][Math.floor(Math.random() * affiliateLinks[category].length)],
                        createdAt: firebase.firestore ? firebase.firestore.FieldValue.serverTimestamp() : new Date()
                    };

                    if (batch) {
                        const docRef = db.collection('products').doc();
                        batch.set(docRef, product);
                        newProducts.push({ id: docRef.id, ...product, createdAt: new Date() });
                    } else {
                        // Demo mode
                        const id = Date.now().toString() + Math.random().toString(36).substring(2);
                        newProducts.push({ id, ...product });
                    }
                }

                if (batch) {
                    await batch.commit();
                    console.log(`Generated ${count} products successfully`);
                }

                // Add to local array
                allProducts.unshift(...newProducts);
                
                // Update displays
                if (currentCategory === 'all' || currentCategory === category) {
                    filteredProducts = currentCategory === 'all' ? [...allProducts] : allProducts.filter(p => p.category === currentCategory);
                    displayProducts(filteredProducts);
                }
                
                loadHomePageProducts();
                updateProductStats();

                // Reset form
                document.getElementById('autoCategory').value = '';
                document.getElementById('autoCount').value = '5';

                generateBtn.textContent = originalText;
                generateBtn.disabled = false;

                showNotification(`‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ${count} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üöÄ`);

            } catch (error) {
                console.error('Error generating products:', error);
                showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚ùå', 'error');
                
                const generateBtn = document.getElementById('generateProductsBtn');
                generateBtn.textContent = 'üöÄ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥';
                generateBtn.disabled = false;
            }
        }

        // Bulk update prices
        async function bulkUpdatePrices() {
            const category = document.getElementById('bulkCategory').value;
            const multiplier = parseFloat(document.getElementById('bulkPriceMultiplier').value) || 1;

            if (!category) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚ö†Ô∏è', 'error');
                return;
            }

            if (multiplier <= 0 || multiplier > 10) {
                showNotification('‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 0.1-10 ‚ö†Ô∏è', 'error');
                return;
            }

            try {
                const updateBtn = document.getElementById('bulkUpdatePriceBtn');
                const originalText = updateBtn.textContent;
                updateBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï...';
                updateBtn.disabled = true;

                const productsToUpdate = allProducts.filter(p => p.category === category);
                
                if (productsToUpdate.length === 0) {
                    showNotification('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ô‡∏µ‡πâ ‚ö†Ô∏è', 'error');
                    updateBtn.textContent = originalText;
                    updateBtn.disabled = false;
                    return;
                }

                if (db) {
                    const batch = db.batch();
                    productsToUpdate.forEach(product => {
                        const docRef = db.collection('products').doc(product.id);
                        const newPrice = Math.round(product.price * multiplier);
                        batch.update(docRef, { price: newPrice });
                        
                        // Update local array
                        const localProduct = allProducts.find(p => p.id === product.id);
                        if (localProduct) {
                            localProduct.price = newPrice;
                        }
                    });
                    
                    await batch.commit();
                } else {
                    // Demo mode
                    productsToUpdate.forEach(product => {
                        product.price = Math.round(product.price * multiplier);
                    });
                }

                // Update displays
                if (currentCategory === 'all' || currentCategory === category) {
                    filteredProducts = currentCategory === 'all' ? [...allProducts] : allProducts.filter(p => p.category === currentCategory);
                    displayProducts(filteredProducts);
                }
                
                loadHomePageProducts();
                updateProductStats();

                updateBtn.textContent = originalText;
                updateBtn.disabled = false;

                showNotification(`‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏Ñ‡∏≤ ${productsToUpdate.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üí∞`);

            } catch (error) {
                console.error('Error updating prices:', error);
                showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏Ñ‡∏≤ ‚ùå', 'error');
                
                const updateBtn = document.getElementById('bulkUpdatePriceBtn');
                updateBtn.textContent = 'üí∞ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏Ñ‡∏≤';
                updateBtn.disabled = false;
            }
        }

        // Bulk delete products
        async function bulkDeleteProducts() {
            const category = document.getElementById('bulkCategory').value;

            if (!category) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚ö†Ô∏è', 'error');
                return;
            }

            const productsToDelete = allProducts.filter(p => p.category === category);
            
            if (productsToDelete.length === 0) {
                showNotification('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ô‡∏µ‡πâ ‚ö†Ô∏è', 'error');
                return;
            }

            // Create custom confirmation dialog
            const confirmDialog = document.createElement('div');
            confirmDialog.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center';
            confirmDialog.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-md mx-4">
                    <h3 class="text-lg font-bold mb-4 text-red-600">‚ö†Ô∏è ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö</h3>
                    <p class="mb-4">‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ${productsToDelete.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</p>
                    <p class="text-sm text-gray-600 mb-6">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ</p>
                    <div class="flex space-x-4">
                        <button id="confirmDelete" class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition">
                            ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                        </button>
                        <button id="cancelDelete" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition">
                            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </button>
                    </div>
                </div>
            `;

            document.body.appendChild(confirmDialog);

            document.getElementById('cancelDelete').onclick = () => {
                document.body.removeChild(confirmDialog);
            };

            document.getElementById('confirmDelete').onclick = async () => {
                document.body.removeChild(confirmDialog);

                try {
                    const deleteBtn = document.getElementById('bulkDeleteBtn');
                    const originalText = deleteBtn.textContent;
                    deleteBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö...';
                    deleteBtn.disabled = true;

                    if (db) {
                        const batch = db.batch();
                        productsToDelete.forEach(product => {
                            const docRef = db.collection('products').doc(product.id);
                            batch.delete(docRef);
                        });
                        
                        await batch.commit();
                    }

                    // Remove from local array
                    allProducts = allProducts.filter(p => p.category !== category);
                    
                    // Update displays
                    if (currentCategory === 'all' || currentCategory === category) {
                        filteredProducts = currentCategory === 'all' ? [...allProducts] : allProducts.filter(p => p.category === currentCategory);
                        displayProducts(filteredProducts);
                    }
                    
                    loadHomePageProducts();
                    updateProductStats();

                    deleteBtn.textContent = originalText;
                    deleteBtn.disabled = false;

                    showNotification(`‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ${productsToDelete.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üóëÔ∏è`);

                } catch (error) {
                    console.error('Error deleting products:', error);
                    showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚ùå', 'error');
                    
                    const deleteBtn = document.getElementById('bulkDeleteBtn');
                    deleteBtn.textContent = 'üóëÔ∏è ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î';
                    deleteBtn.disabled = false;
                }
            };
        }

        // Update product statistics
        function updateProductStats() {
            const totalProducts = allProducts.length;
            const avgPrice = totalProducts > 0 ? Math.round(allProducts.reduce((sum, p) => sum + p.price, 0) / totalProducts) : 0;
            
            document.getElementById('totalProducts').textContent = totalProducts;
            document.getElementById('avgPrice').textContent = `‡∏ø${avgPrice.toLocaleString()}`;

            // Category statistics
            const categoryStats = {};
            allProducts.forEach(product => {
                categoryStats[product.category] = (categoryStats[product.category] || 0) + 1;
            });

            const categoryStatsContainer = document.getElementById('categoryStats');
            const categoryNames = {
                mobile: 'üì± ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠',
                computer: 'üíª ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå',
                fashion: 'üëó ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô',
                mother: 'üë∂ ‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å',
                home: 'üè† ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô',
                health: 'üíä ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û'
            };

            categoryStatsContainer.innerHTML = Object.entries(categoryStats)
                .map(([category, count]) => `
                    <div class="flex justify-between">
                        <span>${categoryNames[category] || category}</span>
                        <span class="font-semibold">${count} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
                    </div>
                `).join('');
        }

        // Update product management list
        function updateProductManagementList(filterCategory = '') {
            const container = document.getElementById('productManagementList');
            const productsToShow = filterCategory ? 
                allProducts.filter(p => p.category === filterCategory) : 
                allProducts;

            if (productsToShow.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-2 text-xs">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ô‡∏µ‡πâ</p>';
                return;
            }

            container.innerHTML = productsToShow.map(product => {
                const originalPrice = product.originalPrice || product.price || 0;
                const salePrice = product.salePrice || product.price || 0;
                const discount = getDiscountPercentage(originalPrice, salePrice);
                return `
                <div class="bg-white border rounded p-2 flex items-center justify-between hover:shadow-sm transition">
                    <div class="flex items-center space-x-2">
                        <img src="${product.image}" alt="${product.name}" class="w-8 h-8 object-cover rounded">
                        <div>
                            <h5 class="font-medium text-xs">${product.name.length > 20 ? product.name.substring(0, 20) + '...' : product.name}</h5>
                            <div class="flex items-center space-x-1">
                                <p class="text-xs text-red-600 font-bold">‡∏ø${salePrice.toLocaleString()}</p>
                                ${discount > 0 ? `
                                    <p class="text-xs text-gray-400 line-through">‡∏ø${originalPrice.toLocaleString()}</p>
                                    <span class="text-xs bg-red-100 text-red-600 px-1 rounded">-${discount}%</span>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                    <div class="flex space-x-1">
                        <button onclick="editProduct('${product.id}')" class="bg-blue-500 text-white px-1 py-1 rounded text-xs hover:bg-blue-600 transition">
                            ‚úèÔ∏è
                        </button>
                        <button onclick="deleteProduct('${product.id}')" class="bg-red-500 text-white px-1 py-1 rounded text-xs hover:bg-red-600 transition">
                            üóëÔ∏è
                        </button>
                    </div>
                </div>
            `;}).join('');
        }

        // Edit product function
        function editProduct(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) return;

            // Fill the edit form
            document.getElementById('editProductId').value = product.id;
            document.getElementById('editProductName').value = product.name;
            document.getElementById('editProductOriginalPrice').value = product.originalPrice || product.price || 0;
            document.getElementById('editProductSalePrice').value = product.salePrice || product.price || 0;
            document.getElementById('editProductCategory').value = product.category;
            document.getElementById('editProductImage').value = product.image;
            document.getElementById('editProductAffiliate').value = product.affiliateLink || '';
            document.getElementById('editProductDescription').value = product.description;

            // Calculate and show discount
            calculateEditDiscount();

            // Show modal
            document.getElementById('editProductModal').classList.remove('hidden');
        }

        // Save edited product
        async function saveEditedProduct() {
            const productId = document.getElementById('editProductId').value;
            const name = document.getElementById('editProductName').value;
            const originalPrice = parseInt(document.getElementById('editProductOriginalPrice').value);
            const salePrice = parseInt(document.getElementById('editProductSalePrice').value);
            const category = document.getElementById('editProductCategory').value;
            const image = document.getElementById('editProductImage').value;
            const affiliateLink = document.getElementById('editProductAffiliate').value;
            const description = document.getElementById('editProductDescription').value;

            if (!name || !originalPrice || !salePrice || !category || !image || !description) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‚ö†Ô∏è', 'error');
                return;
            }

            if (salePrice >= originalPrice) {
                showNotification('‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ï‡πá‡∏° ‚ö†Ô∏è', 'error');
                return;
            }

            try {
                const saveBtn = document.getElementById('saveEditBtn');
                const originalText = saveBtn.textContent;
                saveBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
                saveBtn.disabled = true;

                const updatedProduct = {
                    name,
                    originalPrice,
                    salePrice,
                    category,
                    image,
                    description,
                    affiliateLink: affiliateLink || null
                };

                if (db) {
                    // Update in Firestore
                    await db.collection('products').doc(productId).update(updatedProduct);
                }

                // Update local array
                const productIndex = allProducts.findIndex(p => p.id === productId);
                if (productIndex !== -1) {
                    allProducts[productIndex] = { ...allProducts[productIndex], ...updatedProduct };
                }

                // Update displays
                if (currentCategory === 'all' || currentCategory === category) {
                    filteredProducts = currentCategory === 'all' ? [...allProducts] : allProducts.filter(p => p.category === currentCategory);
                    displayProducts(filteredProducts);
                }
                
                loadHomePageProducts();
                updateProductStats();
                updateProductManagementList(document.getElementById('manageCategory').value);

                // Close modal
                document.getElementById('editProductModal').classList.add('hidden');

                saveBtn.textContent = originalText;
                saveBtn.disabled = false;

                showNotification('‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‚úÖ');

            } catch (error) {
                console.error('Error updating product:', error);
                showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚ùå', 'error');
                
                const saveBtn = document.getElementById('saveEditBtn');
                saveBtn.textContent = 'üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç';
                saveBtn.disabled = false;
            }
        }

        // Delete product function
        async function deleteProduct(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) return;

            // Create custom confirmation dialog
            const confirmDialog = document.createElement('div');
            confirmDialog.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center';
            confirmDialog.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-md mx-4">
                    <h3 class="text-lg font-bold mb-4 text-red-600">‚ö†Ô∏è ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                    <div class="flex items-center space-x-3 mb-4">
                        <img src="${product.image}" alt="${product.name}" class="w-16 h-16 object-cover rounded">
                        <div>
                            <p class="font-medium">${product.name}</p>
                            <p class="text-sm text-gray-600">‡∏ø${product.price.toLocaleString()}</p>
                        </div>
                    </div>
                    <p class="text-sm text-gray-600 mb-6">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ</p>
                    <div class="flex space-x-4">
                        <button id="confirmDeleteSingle" class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition">
                            ‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                        </button>
                        <button id="cancelDeleteSingle" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition">
                            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </button>
                    </div>
                </div>
            `;

            document.body.appendChild(confirmDialog);

            document.getElementById('cancelDeleteSingle').onclick = () => {
                document.body.removeChild(confirmDialog);
            };

            document.getElementById('confirmDeleteSingle').onclick = async () => {
                document.body.removeChild(confirmDialog);

                try {
                    if (db) {
                        // Delete from Firestore
                        await db.collection('products').doc(productId).delete();
                    }

                    // Remove from local array
                    allProducts = allProducts.filter(p => p.id !== productId);
                    
                    // Update displays
                    if (currentCategory === 'all' || currentCategory === product.category) {
                        filteredProducts = currentCategory === 'all' ? [...allProducts] : allProducts.filter(p => p.category === currentCategory);
                        displayProducts(filteredProducts);
                    }
                    
                    loadHomePageProducts();
                    updateProductStats();
                    updateProductManagementList(document.getElementById('manageCategory').value);

                    showNotification('‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üóëÔ∏è');

                } catch (error) {
                    console.error('Error deleting product:', error);
                    showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚ùå', 'error');
                }
            };
        }

        // Global variable to store current smart product preview
        let currentSmartProduct = null;

        // Toggle manual form visibility
        function toggleManualForm() {
            const form = document.getElementById('manualProductForm');
            const icon = document.getElementById('toggleIcon');
            
            if (form.classList.contains('hidden')) {
                form.classList.remove('hidden');
                icon.textContent = '‚ñ≤';
            } else {
                form.classList.add('hidden');
                icon.textContent = '‚ñº';
            }
        }

        // Preview smart product from link
        function previewSmartProduct() {
            const link = document.getElementById('smartProductLink').value.trim();
            const selectedCategory = document.getElementById('smartProductCategory').value;
            
            if (!link) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚ö†Ô∏è', 'error');
                return;
            }

            try {
                const previewBtn = document.getElementById('previewProductBtn');
                const originalText = previewBtn.textContent;
                previewBtn.textContent = 'üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á...';
                previewBtn.disabled = true;

                let product = null;
                
                // Check if it's a Shopee URL
                if (link.includes('shopee.co.th') || link.includes('shopee.com')) {
                    product = extractShopeeInfo(link);
                    if (selectedCategory) {
                        product.category = selectedCategory;
                        // Update prices based on selected category
                        const mockPrices = generateMockPrices(selectedCategory);
                        product.originalPrice = mockPrices.original;
                        product.salePrice = mockPrices.sale;
                        product.image = getDefaultImageForCategory(selectedCategory);
                        product.description = `‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å Shopee ${getCategoryName(selectedCategory)} ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ ‡∏°‡∏µ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏î‡∏µ`;
                    }
                }
                // Check if it's a Lazada URL
                else if (link.includes('lazada.co.th') || link.includes('lazada.com')) {
                    product = extractLazadaInfo(link);
                    if (selectedCategory) {
                        product.category = selectedCategory;
                        const mockPrices = generateMockPrices(selectedCategory);
                        product.originalPrice = mockPrices.original;
                        product.salePrice = mockPrices.sale;
                        product.image = getDefaultImageForCategory(selectedCategory);
                        product.description = `‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å Lazada ${getCategoryName(selectedCategory)} ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û`;
                    }
                }
                // Generic URL handling
                else if (link.startsWith('http')) {
                    const urlParts = link.split('/');
                    const lastPart = urlParts[urlParts.length - 1] || urlParts[urlParts.length - 2];
                    let productName = lastPart.replace(/[-_]/g, ' ').replace(/\b\w/g, l => l.toUpperCase()) || '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå';
                    
                    // Clean up common URL patterns
                    productName = productName.replace(/\.(html|php|aspx?)$/i, '');
                    productName = productName.replace(/\?.*$/, ''); // Remove query parameters
                    
                    const category = selectedCategory || detectCategoryFromUrl(link);
                    const mockPrices = generateMockPrices(category);
                    
                    product = {
                        id: 'smart-' + Date.now(),
                        name: productName,
                        originalPrice: mockPrices.original,
                        salePrice: mockPrices.sale,
                        category: category,
                        image: getDefaultImageForCategory(category),
                        description: `‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ${getCategoryName(category)} ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ`,
                        affiliateLink: link,
                        isSmartProduct: true
                    };
                }

                if (!product) {
                    showNotification('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏•‡∏¥‡∏á‡∏Ñ‡πå ‚ö†Ô∏è', 'error');
                    previewBtn.textContent = originalText;
                    previewBtn.disabled = false;
                    return;
                }

                // Store current product for adding later
                currentSmartProduct = product;

                // Show preview
                displaySmartProductPreview(product);
                
                previewBtn.textContent = originalText;
                previewBtn.disabled = false;

                showNotification('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üëÅÔ∏è', 'success');

            } catch (error) {
                console.error('Error previewing smart product:', error);
                showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‚ùå', 'error');
                
                const previewBtn = document.getElementById('previewProductBtn');
                previewBtn.textContent = 'üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á';
                previewBtn.disabled = false;
            }
        }

        // Display smart product preview
        function displaySmartProductPreview(product) {
            const previewArea = document.getElementById('smartProductPreview');
            const previewContent = document.getElementById('previewContent');
            
            const discount = getDiscountPercentage(product.originalPrice, product.salePrice);
            
            previewContent.innerHTML = `
                <div class="flex items-start space-x-3">
                    <img src="${product.image}" alt="${product.name}" class="w-16 h-16 object-cover rounded border">
                    <div class="flex-1">
                        <div class="flex items-center space-x-2 mb-1">
                            <h6 class="font-semibold text-purple-800">${product.name}</h6>
                            ${discount > 0 ? `
                                <span class="bg-red-500 text-white px-1 py-0.5 rounded text-xs">-${discount}%</span>
                            ` : ''}
                        </div>
                        <p class="text-gray-600 mb-2">${product.description}</p>
                        <div class="flex items-center justify-between">
                            <div>
                                <span class="font-bold text-red-600">‡∏ø${product.salePrice.toLocaleString()}</span>
                                ${discount > 0 ? `
                                    <span class="text-gray-500 line-through ml-1">‡∏ø${product.originalPrice.toLocaleString()}</span>
                                ` : ''}
                            </div>
                            <span class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded text-xs">
                                ${getCategoryName(product.category)}
                            </span>
                        </div>
                        <div class="mt-2 text-xs text-gray-500">
                            üîó ${product.affiliateLink}
                        </div>
                    </div>
                </div>
            `;
            
            previewArea.classList.remove('hidden');
        }

        // Add smart product to database
        async function addSmartProduct() {
            if (!currentSmartProduct) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô ‚ö†Ô∏è', 'error');
                return;
            }

            try {
                const addBtn = document.getElementById('addSmartProductBtn');
                const originalText = addBtn.textContent;
                addBtn.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°...';
                addBtn.disabled = true;

                const newProduct = {
                    name: currentSmartProduct.name,
                    originalPrice: currentSmartProduct.originalPrice,
                    salePrice: currentSmartProduct.salePrice,
                    category: currentSmartProduct.category,
                    image: currentSmartProduct.image,
                    description: currentSmartProduct.description,
                    affiliateLink: currentSmartProduct.affiliateLink,
                    createdAt: firebase.firestore ? firebase.firestore.FieldValue.serverTimestamp() : new Date()
                };

                let productId;
                if (db) {
                    // Add to Firestore
                    const docRef = await db.collection('products').add(newProduct);
                    productId = docRef.id;
                    console.log('Smart product added with ID:', productId);
                } else {
                    // Demo mode
                    productId = Date.now().toString();
                }

                // Add to local array with generated ID
                allProducts.unshift({
                    id: productId,
                    ...newProduct,
                    createdAt: new Date()
                });
                
                // Update filtered products if showing all or same category
                if (currentCategory === 'all' || currentCategory === currentSmartProduct.category) {
                    filteredProducts = currentCategory === 'all' ? [...allProducts] : allProducts.filter(p => p.category === currentCategory);
                    displayProducts(filteredProducts);
                }
                
                // Update displays
                loadHomePageProducts();
                updateProductStats();
                updateProductManagementList();
                
                // Clear form and preview
                document.getElementById('smartProductLink').value = '';
                document.getElementById('smartProductCategory').value = '';
                document.getElementById('smartProductPreview').classList.add('hidden');
                currentSmartProduct = null;

                addBtn.textContent = originalText;
                addBtn.disabled = false;

                showNotification('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‚ú®', 'success');

            } catch (error) {
                console.error('Error adding smart product:', error);
                showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚ùå', 'error');
                
                const addBtn = document.getElementById('addSmartProductBtn');
                addBtn.textContent = '‚ú® ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤';
                addBtn.disabled = false;
            }
        }

        // Enhanced extract functions with better category detection
        function extractShopeeInfo(url) {
            try {
                let productName = '';
                
                // Extract product name from URL
                const urlParts = url.split('/');
                const productPart = urlParts.find(part => part.includes('-i.'));
                
                if (productPart) {
                    productName = productPart.split('-i.')[0];
                    productName = productName.replace(/-/g, ' ');
                    productName = productName.replace(/\b\w/g, l => l.toUpperCase());
                } else {
                    const nameMatch = url.match(/\/([^\/]+)-i\./);
                    if (nameMatch) {
                        productName = nameMatch[1].replace(/-/g, ' ');
                        productName = productName.replace(/\b\w/g, l => l.toUpperCase());
                    }
                }

                if (!productName) {
                    const pathParts = url.split('/').filter(part => part && !part.includes('.'));
                    productName = pathParts[pathParts.length - 1] || '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å Shopee';
                    productName = productName.replace(/-/g, ' ').replace(/_/g, ' ');
                    productName = productName.replace(/\b\w/g, l => l.toUpperCase());
                }

                const category = detectCategoryFromUrl(url);
                const mockPrices = generateMockPrices(category);
                
                return {
                    id: 'shopee-' + Date.now(),
                    name: productName,
                    originalPrice: mockPrices.original,
                    salePrice: mockPrices.sale,
                    category: category,
                    image: getDefaultImageForCategory(category),
                    description: `‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å Shopee ${getCategoryName(category)} ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ ‡∏°‡∏µ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏î‡∏µ`,
                    affiliateLink: url,
                    isShopeeProduct: true
                };
            } catch (error) {
                console.error('Error extracting Shopee info:', error);
                return null;
            }
        }

        function extractLazadaInfo(url) {
            try {
                let productName = '';
                
                const nameMatch = url.match(/\/([^\/]+)\.html/);
                if (nameMatch) {
                    productName = nameMatch[1].replace(/-/g, ' ');
                    productName = productName.replace(/\b\w/g, l => l.toUpperCase());
                }

                if (!productName) {
                    const pathParts = url.split('/').filter(part => part && !part.includes('.'));
                    productName = pathParts[pathParts.length - 1] || '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å Lazada';
                    productName = productName.replace(/-/g, ' ').replace(/_/g, ' ');
                    productName = productName.replace(/\b\w/g, l => l.toUpperCase());
                }

                const category = detectCategoryFromUrl(url);
                const mockPrices = generateMockPrices(category);
                
                return {
                    id: 'lazada-' + Date.now(),
                    name: productName,
                    originalPrice: mockPrices.original,
                    salePrice: mockPrices.sale,
                    category: category,
                    image: getDefaultImageForCategory(category),
                    description: `‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å Lazada ${getCategoryName(category)} ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û`,
                    affiliateLink: url,
                    isLazadaProduct: true
                };
            } catch (error) {
                console.error('Error extracting Lazada info:', error);
                return null;
            }
        }

        // Add product to Firestore
        async function addProduct() {
            const name = document.getElementById('productName').value;
            const originalPrice = parseInt(document.getElementById('productOriginalPrice').value);
            const salePrice = parseInt(document.getElementById('productSalePrice').value);
            const category = document.getElementById('productCategory').value;
            const image = document.getElementById('productImage').value;
            const affiliateLink = document.getElementById('productAffiliate').value;
            const description = document.getElementById('productDescription').value;

            if (name && originalPrice && salePrice && category && image && description) {
                if (salePrice >= originalPrice) {
                    showNotification('‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ï‡πá‡∏° ‚ö†Ô∏è', 'error');
                    return;
                }
                try {
                    // Show loading
                    const addBtn = document.getElementById('addProductBtn');
                    const originalText = addBtn.textContent;
                    addBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°...';
                    addBtn.disabled = true;

                    const newProduct = {
                        name,
                        originalPrice,
                        salePrice,
                        category,
                        image,
                        description,
                        affiliateLink: affiliateLink || null,
                        createdAt: firebase.firestore ? firebase.firestore.FieldValue.serverTimestamp() : new Date()
                    };

                    let productId;
                    if (db) {
                        // Add to Firestore
                        const docRef = await db.collection('products').add(newProduct);
                        productId = docRef.id;
                        console.log('Product added with ID:', productId);
                    } else {
                        // Demo mode
                        productId = Date.now().toString();
                    }

                    // Add to local array with generated ID
                    allProducts.unshift({
                        id: productId,
                        ...newProduct,
                        createdAt: new Date() // For local display
                    });
                    
                    // Update filtered products if showing all or same category
                    if (currentCategory === 'all' || currentCategory === category) {
                        filteredProducts = currentCategory === 'all' ? [...allProducts] : allProducts.filter(p => p.category === currentCategory);
                        displayProducts(filteredProducts);
                    }
                    
                    // Update home page products and stats
                    loadHomePageProducts();
                    updateProductStats();
                    updateProductManagementList();
                    
                    // Clear form
                    document.getElementById('productName').value = '';
                    document.getElementById('productOriginalPrice').value = '';
                    document.getElementById('productSalePrice').value = '';
                    document.getElementById('productCategory').value = '';
                    document.getElementById('productImage').value = '';
                    document.getElementById('productAffiliate').value = '';
                    document.getElementById('productDescription').value = '';
                    document.getElementById('discountDisplay').textContent = '‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î: 0%';
                    document.getElementById('discountDisplay').className = 'text-xs text-gray-500 font-bold';

                    // Reset button
                    addBtn.textContent = originalText;
                    addBtn.disabled = false;

                    showNotification('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‚úÖ');

                } catch (error) {
                    console.error('Error adding product:', error);
                    showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚ùå', 'error');
                    
                    // Reset button
                    const addBtn = document.getElementById('addProductBtn');
                    addBtn.textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤';
                    addBtn.disabled = false;
                }
            } else {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô (‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ï‡πá‡∏°, ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢, ‡∏•‡∏¥‡∏á‡∏Ñ‡πå Affiliate ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö) ‚ö†Ô∏è', 'error');
            }
        }

        // Logout with Firebase Auth
        async function logout() {
            try {
                if (auth && currentUser) {
                    await auth.signOut();
                    showNotification('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß üëã');
                } else {
                    // Fallback for demo mode
                    currentUser = null;
                    updateAdminUI(false);
                    showNotification('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß üëã');
                }
            } catch (error) {
                console.error('Logout error:', error);
                showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö ‚ùå', 'error');
            }
        }

        // Show Flash Sale
        function showFlashSale(type) {
            showPage('flashsale');
            
            const titles = {
                'main': 'üî• Flash Sale ‡∏´‡∏•‡∏±‡∏Å',
                'today': 'üìÖ Flash Sale ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ',
                'weekend': 'üéØ Flash Sale ‡∏™‡∏∏‡∏î‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå',
                'mega': 'üí• Mega Flash Sale'
            };
            
            document.getElementById('flashSaleTitle').textContent = titles[type];
            
            // Show flash sale products with same discount as other pages
            const flashSaleProducts = allProducts.map(product => ({
                ...product,
                originalPrice: product.price,
                price: Math.floor(product.price * 0.7), // 30% discount
                discount: 30
            }));
            
            displayFlashSaleProducts(flashSaleProducts);
            startCountdown();
        }

        // Show Promotion
        function showPromotion(category) {
            showPage('promotion');
            
            const titles = {
                'mobile': 'üì± ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠',
                'computer': 'üíª ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå',
                'fashion': 'üëó ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô',
                'mother': 'üë∂ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å',
                'home': 'üè† ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô',
                'health': 'üíä ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û'
            };
            
            document.getElementById('promotionTitle').textContent = titles[category];
            
            // Filter products by category - show original prices
            const promotionProducts = allProducts
                .filter(product => product.category === category);
            
            displayPromotionProducts(promotionProducts);
        }

        // Display Flash Sale Products
        function displayFlashSaleProducts(products) {
            const container = document.getElementById('flashSaleProducts');
            
            container.innerHTML = products.map(product => `
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition fade-in relative cursor-pointer" onclick="showProductDetail('${product.id}')">
                    <div class="absolute top-2 left-2 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold">
                        -${product.discount}%
                    </div>
                    <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover">
                    <div class="p-4">
                        <h3 class="font-semibold text-lg mb-2">${product.name}</h3>
                        <p class="text-gray-600 text-sm mb-3">${product.description}</p>
                        <div class="flex justify-between items-center mb-3">
                            <div>
                                <span class="text-xl font-bold text-red-600">‡∏ø${product.price.toLocaleString()}</span>
                                <span class="text-sm text-gray-500 line-through ml-2">‡∏ø${product.originalPrice.toLocaleString()}</span>
                            </div>
                        </div>
                        <div class="flex space-x-2" onclick="event.stopPropagation()">
                            <button onclick="addToCart('${product.id}')" class="flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition">
                                ‚ö° ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
                            </button>
                            ${product.affiliateLink ? `
                                <a href="${product.affiliateLink}" target="_blank" class="flex-1 bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition text-center">
                                    üõçÔ∏è ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏¢
                                </a>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Display Promotion Products
        function displayPromotionProducts(products) {
            const container = document.getElementById('promotionProducts');
            
            container.innerHTML = products.map(product => {
                const originalPrice = product.price;
                const discountedPrice = Math.floor(product.price * 0.7); // 30% discount
                return `
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition fade-in relative cursor-pointer" onclick="showProductDetail('${product.id}')">
                    <div class="absolute top-2 left-2 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold">
                        -30%
                    </div>
                    <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover">
                    <div class="p-4">
                        <h3 class="font-semibold text-lg mb-2">${product.name}</h3>
                        <p class="text-gray-600 text-sm mb-3">${product.description}</p>
                        <div class="flex justify-between items-center mb-3">
                            <div>
                                <span class="text-xl font-bold text-red-600">‡∏ø${discountedPrice.toLocaleString()}</span>
                                <span class="text-sm text-gray-500 line-through ml-2">‡∏ø${originalPrice.toLocaleString()}</span>
                            </div>
                        </div>
                        <div class="flex space-x-2" onclick="event.stopPropagation()">
                            <button onclick="addToCart('${product.id}')" class="flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition">
                                ‚ö° ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
                            </button>
                            ${product.affiliateLink ? `
                                <a href="${product.affiliateLink}" target="_blank" class="flex-1 bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition text-center">
                                    üõçÔ∏è ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏¢
                                </a>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;}).join('');
        }

        // Start countdown timer
        function startCountdown() {
            let hours = 23;
            let minutes = 59;
            let seconds = 45;
            
            const countdownElement = document.getElementById('countdown');
            
            const timer = setInterval(() => {
                seconds--;
                
                if (seconds < 0) {
                    seconds = 59;
                    minutes--;
                }
                
                if (minutes < 0) {
                    minutes = 59;
                    hours--;
                }
                
                if (hours < 0) {
                    clearInterval(timer);
                    countdownElement.textContent = "00:00:00";
                    return;
                }
                
                const formattedTime = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                countdownElement.textContent = formattedTime;
            }, 1000);
        }

        // Show product detail modal
        function showProductDetail(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) return;

            // Add structured data for the product
            addProductStructuredData(product);

            const modal = document.getElementById('productDetailModal');
            const content = document.getElementById('productDetailContent');

            content.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <img src="${product.image}" alt="${product.name}" class="w-full h-64 md:h-80 object-cover rounded-lg shadow-md">
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold mb-4">${product.name}</h2>
                        <div class="mb-4">
                            <span class="inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">
                                ${getCategoryName(product.category)}
                            </span>
                        </div>
                        <div class="mb-6">
                            <span class="text-3xl font-bold text-blue-600">‡∏ø${product.price.toLocaleString()}</span>
                        </div>
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold mb-2">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                            <p class="text-gray-600 leading-relaxed">${product.description}</p>
                        </div>
                        <div class="space-y-3">
                            <button onclick="addToCart('${product.id}'); showNotification('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß! üõí');" class="w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition font-medium">
                                üõí ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
                            </button>
                            ${product.affiliateLink ? `
                                <a href="${product.affiliateLink}" target="_blank" class="block w-full bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition text-center font-medium">
                                    üõçÔ∏è ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏¢
                                </a>
                            ` : ''}
                            <button onclick="document.getElementById('productDetailModal').classList.add('hidden')" class="w-full bg-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-400 transition font-medium">
                                ‡∏õ‡∏¥‡∏î
                            </button>
                        </div>
                    </div>
                </div>
            `;

            modal.classList.remove('hidden');
        }

        // Get category name in Thai
        function getCategoryName(category) {
            const categoryNames = {
                mobile: 'üì± ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠',
                computer: 'üíª ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå',
                fashion: 'üëó ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô',
                mother: 'üë∂ ‡πÅ‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πá‡∏Å',
                home: 'üè† ‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô',
                health: 'üíä ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û'
            };
            return categoryNames[category] || category;
        }

        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `fixed top-20 right-4 z-50 px-6 py-3 rounded-lg text-white font-medium ${
                type === 'error' ? 'bg-red-500' : 'bg-green-500'
            } fade-in`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Draggable modal functionality
        let isDragging = false;
        let dragOffset = { x: 0, y: 0 };

        function initDraggableModal() {
            const modal = document.getElementById('adminModalContent');
            const modalContainer = document.getElementById('adminModal');
            const header = document.getElementById('modalHeader');
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
            
            // Only allow dragging from header area
            header.addEventListener('mousedown', function(e) {
                // Don't drag if clicking on close button
                if (e.target.id === 'closeAdminModal' || e.target.closest('#closeAdminModal')) {
                    return;
                }
                startDrag(e);
            });
            
            // Also allow dragging from modal background (not form elements)
            modal.addEventListener('mousedown', function(e) {
                // Only allow dragging from empty areas, not form elements
                if (e.target === modal || e.target.closest('#modalHeader')) {
                    if (e.target.id !== 'closeAdminModal' && !e.target.closest('#closeAdminModal')) {
                        startDrag(e);
                    }
                }
            });
            
            function startDrag(e) {
                isDragging = true;
                const rect = modal.getBoundingClientRect();
                dragOffset.x = e.clientX - rect.left;
                dragOffset.y = e.clientY - rect.top;
                
                modal.style.position = 'fixed';
                modal.style.zIndex = '9999';
                modal.style.transition = 'none';
                modal.style.boxShadow = '0 25px 50px -12px rgba(0, 0, 0, 0.25)';
                modal.style.transform = 'scale(1.02)';
                document.body.style.cursor = 'grabbing';
                
                e.preventDefault();
            }
            
            function drag(e) {
                if (!isDragging) return;
                
                const x = e.clientX - dragOffset.x;
                const y = e.clientY - dragOffset.y;
                
                // Keep modal within viewport bounds
                const maxX = window.innerWidth - modal.offsetWidth;
                const maxY = window.innerHeight - modal.offsetHeight;
                
                const boundedX = Math.max(0, Math.min(x, maxX));
                const boundedY = Math.max(0, Math.min(y, maxY));
                
                modal.style.left = boundedX + 'px';
                modal.style.top = boundedY + 'px';
                modal.style.transform = 'none';
                
                e.preventDefault();
            }
            
            function stopDrag() {
                if (isDragging) {
                    isDragging = false;
                    modal.style.transition = 'all 0.2s ease';
                    modal.style.boxShadow = '';
                    modal.style.transform = '';
                    document.body.style.cursor = '';
                    
                    // Smooth transition back
                    setTimeout(() => {
                        modal.style.transition = '';
                    }, 200);
                }
            }
            
            // Reset modal position when opened
            modalContainer.addEventListener('click', function(e) {
                if (e.target === modalContainer) {
                    resetModalPosition();
                }
            });
            
            function resetModalPosition() {
                modal.style.position = '';
                modal.style.left = '';
                modal.style.top = '';
                modal.style.transform = '';
                modal.style.zIndex = '';
                modal.style.boxShadow = '';
                document.body.style.cursor = '';
            }
            
            // Reset position when modal is shown
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                        if (!modalContainer.classList.contains('hidden')) {
                            resetModalPosition();
                        }
                    }
                });
            });
            
            observer.observe(modalContainer, { attributes: true });
        }

        // Enhanced scroll functionality for modal content
        function initModalScroll() {
            const modal = document.getElementById('adminModalContent');
            
            // Smooth scrolling with mouse wheel
            modal.addEventListener('wheel', function(e) {
                e.preventDefault();
                
                const scrollAmount = e.deltaY * 0.5; // Adjust scroll sensitivity
                modal.scrollTop += scrollAmount;
                
                // Add smooth scroll effect
                modal.style.scrollBehavior = 'smooth';
                setTimeout(() => {
                    modal.style.scrollBehavior = 'auto';
                }, 100);
            });
            
            // Custom scrollbar styling
            const style = document.createElement('style');
            style.textContent = `
                #adminModalContent::-webkit-scrollbar {
                    width: 8px;
                }
                
                #adminModalContent::-webkit-scrollbar-track {
                    background: #f1f1f1;
                    border-radius: 4px;
                }
                
                #adminModalContent::-webkit-scrollbar-thumb {
                    background: #c1c1c1;
                    border-radius: 4px;
                    transition: background 0.2s;
                }
                
                #adminModalContent::-webkit-scrollbar-thumb:hover {
                    background: #a1a1a1;
                }
                
                #adminModalContent {
                    scrollbar-width: thin;
                    scrollbar-color: #c1c1c1 #f1f1f1;
                }
            `;
            document.head.appendChild(style);
        }

        // Extract product info from Shopee URL
        function extractShopeeInfo(url) {
            try {
                // Extract product name from URL
                let productName = '';
                
                // Try to extract from URL path
                const urlParts = url.split('/');
                const productPart = urlParts.find(part => part.includes('-i.'));
                
                if (productPart) {
                    // Extract name before -i.
                    productName = productPart.split('-i.')[0];
                    productName = productName.replace(/-/g, ' ');
                    productName = productName.replace(/\b\w/g, l => l.toUpperCase());
                } else {
                    // Try to extract from other URL patterns
                    const nameMatch = url.match(/\/([^\/]+)-i\./);
                    if (nameMatch) {
                        productName = nameMatch[1].replace(/-/g, ' ');
                        productName = productName.replace(/\b\w/g, l => l.toUpperCase());
                    }
                }

                // If still no name, generate from URL
                if (!productName) {
                    const pathParts = url.split('/').filter(part => part && !part.includes('.'));
                    productName = pathParts[pathParts.length - 1] || '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å Shopee';
                    productName = productName.replace(/-/g, ' ').replace(/_/g, ' ');
                    productName = productName.replace(/\b\w/g, l => l.toUpperCase());
                }

                // Generate mock product data based on URL analysis
                const category = detectCategoryFromUrl(url);
                const mockPrices = generateMockPrices(category);
                
                return {
                    id: 'shopee-' + Date.now(),
                    name: productName,
                    originalPrice: mockPrices.original,
                    salePrice: mockPrices.sale,
                    category: category,
                    image: getDefaultImageForCategory(category),
                    description: `‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å Shopee ${getCategoryName(category)} ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ ‡∏°‡∏µ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏î‡∏µ`,
                    affiliateLink: url,
                    isShopeeProduct: true
                };
            } catch (error) {
                console.error('Error extracting Shopee info:', error);
                return null;
            }
        }

        // Detect category from Shopee URL
        function detectCategoryFromUrl(url) {
            const urlLower = url.toLowerCase();
            
            if (urlLower.includes('phone') || urlLower.includes('mobile') || urlLower.includes('iphone') || urlLower.includes('samsung') || urlLower.includes('smartphone')) {
                return 'mobile';
            } else if (urlLower.includes('laptop') || urlLower.includes('computer') || urlLower.includes('macbook') || urlLower.includes('pc')) {
                return 'computer';
            } else if (urlLower.includes('fashion') || urlLower.includes('clothing') || urlLower.includes('shirt') || urlLower.includes('dress') || urlLower.includes('shoes')) {
                return 'fashion';
            } else if (urlLower.includes('baby') || urlLower.includes('kids') || urlLower.includes('mother') || urlLower.includes('child')) {
                return 'mother';
            } else if (urlLower.includes('home') || urlLower.includes('garden') || urlLower.includes('furniture') || urlLower.includes('decor')) {
                return 'home';
            } else if (urlLower.includes('health') || urlLower.includes('vitamin') || urlLower.includes('supplement') || urlLower.includes('beauty')) {
                return 'health';
            }
            
            return 'mobile'; // Default category
        }

        // Generate mock prices based on category
        function generateMockPrices(category) {
            const priceRanges = {
                mobile: { min: 5000, max: 50000 },
                computer: { min: 15000, max: 80000 },
                fashion: { min: 200, max: 2000 },
                mother: { min: 100, max: 3000 },
                home: { min: 300, max: 5000 },
                health: { min: 200, max: 2000 }
            };
            
            const range = priceRanges[category] || priceRanges.mobile;
            const originalPrice = Math.floor(Math.random() * (range.max - range.min) + range.min);
            const discountPercent = Math.floor(Math.random() * 40 + 10); // 10-50% discount
            const salePrice = Math.floor(originalPrice * (100 - discountPercent) / 100);
            
            return {
                original: originalPrice,
                sale: salePrice
            };
        }

        // Get default image for category
        function getDefaultImageForCategory(category) {
            const defaultImages = {
                mobile: 'https://images.unsplash.com/photo-1592750475338-74b7b21085ab?w=400',
                computer: 'https://images.unsplash.com/photo-1541807084-5c52b6b3adef?w=400',
                fashion: 'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=400',
                mother: 'https://images.unsplash.com/photo-1515488042361-ee00e0ddd4e4?w=400',
                home: 'https://images.unsplash.com/photo-1416879595882-3373a0480b5b?w=400',
                health: 'https://images.unsplash.com/photo-1584308666744-24d5c474f2ae?w=400'
            };
            
            return defaultImages[category] || defaultImages.mobile;
        }

        // Extract product info from Lazada URL
        function extractLazadaInfo(url) {
            try {
                let productName = '';
                
                // Extract from Lazada URL pattern
                const nameMatch = url.match(/\/([^\/]+)\.html/);
                if (nameMatch) {
                    productName = nameMatch[1].replace(/-/g, ' ');
                    productName = productName.replace(/\b\w/g, l => l.toUpperCase());
                }

                if (!productName) {
                    const pathParts = url.split('/').filter(part => part && !part.includes('.'));
                    productName = pathParts[pathParts.length - 1] || '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å Lazada';
                    productName = productName.replace(/-/g, ' ').replace(/_/g, ' ');
                    productName = productName.replace(/\b\w/g, l => l.toUpperCase());
                }

                const category = detectCategoryFromUrl(url);
                const mockPrices = generateMockPrices(category);
                
                return {
                    id: 'lazada-' + Date.now(),
                    name: productName,
                    originalPrice: mockPrices.original,
                    salePrice: mockPrices.sale,
                    category: category,
                    image: getDefaultImageForCategory(category),
                    description: `‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å Lazada ${getCategoryName(category)} ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û`,
                    affiliateLink: url,
                    isLazadaProduct: true
                };
            } catch (error) {
                console.error('Error extracting Lazada info:', error);
                return null;
            }
        }

        // Global variable to store current admin preview product
        let currentAdminPreviewProduct = null;

        // Admin Link Preview functions
        async function adminGenerateLinkPreview() {
            const input = document.getElementById('adminLinkPreviewInput').value.trim();
            if (!input) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚ö†Ô∏è', 'error');
                return;
            }

            // Show loading state
            const generateBtn = document.querySelector('button[onclick="adminGenerateLinkPreview()"]');
            const originalText = generateBtn.textContent;
            generateBtn.textContent = 'üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
            generateBtn.disabled = true;

            let product = null;
            
            try {
                // Check if it's a URL that we can fetch metadata from
                if (input.startsWith('http')) {
                    product = await fetchUrlMetadata(input);
                    if (product) {
                        showNotification('‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üîó', 'success');
                    }
                }
                
                // Fallback to existing logic if URL fetch fails
                if (!product) {
                    // Check if it's a Shopee URL
                    if (input.includes('shopee.co.th') || input.includes('shopee.com')) {
                        product = extractShopeeInfo(input);
                        if (product) {
                            showNotification('‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Shopee ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üü†', 'success');
                        }
                    }
                    // Check if it's a Lazada URL
                    else if (input.includes('lazada.co.th') || input.includes('lazada.com')) {
                        product = extractLazadaInfo(input);
                        if (product) {
                            showNotification('‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Lazada ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üîµ', 'success');
                        }
                    }
                    // If it's any other URL, try to extract info
                    else if (input.startsWith('http')) {
                        product = await extractGenericUrlInfo(input);
                        if (product) {
                            showNotification('‡∏™‡∏£‡πâ‡∏≤‡∏á Preview ‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üîó', 'success');
                        }
                    }
                }

                if (!product) {
                    showNotification('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á Preview ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå ‚ö†Ô∏è', 'error');
                    return;
                }

                // Store current product for adding later
                currentAdminPreviewProduct = product;

                // Show preview in admin panel
                displayAdminLinkPreview(product, input);
                
                // Enable add button
                document.getElementById('adminAddFromPreviewBtn').disabled = false;

            } catch (error) {
                console.error('Error generating admin link preview:', error);
                showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‚ö†Ô∏è', 'error');
            } finally {
                // Reset button
                generateBtn.textContent = originalText;
                generateBtn.disabled = false;
            }
        }

        // Display admin link preview
        function displayAdminLinkPreview(product, originalUrl) {
            const container = document.getElementById('adminLinkPreviewContainer');
            const originalPrice = product.originalPrice || product.price || 0;
            const salePrice = product.salePrice || product.price || 0;
            const discount = getDiscountPercentage(originalPrice, salePrice);
            
            container.innerHTML = `
                <div class="border border-green-300 rounded-lg overflow-hidden bg-white shadow-sm">
                    <div class="bg-green-50 px-4 py-2 border-b border-green-200">
                        <h5 class="text-sm font-semibold text-green-800">üìã ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°</h5>
                    </div>
                    <div class="p-4">
                        <div class="flex space-x-4">
                            <div class="w-20 h-20 flex-shrink-0">
                                <img src="${product.image}" alt="${product.name}" class="w-full h-full object-cover rounded border">
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center space-x-2 mb-2">
                                    <h6 class="font-semibold text-gray-800">${product.name}</h6>
                                    ${discount > 0 ? `
                                        <span class="bg-red-500 text-white px-2 py-0.5 rounded text-xs">-${discount}%</span>
                                    ` : ''}
                                </div>
                                <p class="text-gray-600 text-sm mb-2">${product.description}</p>
                                <div class="flex items-center justify-between">
                                    <div>
                                        <span class="font-bold text-red-600">‡∏ø${salePrice.toLocaleString()}</span>
                                        ${discount > 0 ? `
                                            <span class="text-gray-500 line-through ml-1 text-sm">‡∏ø${originalPrice.toLocaleString()}</span>
                                        ` : ''}
                                    </div>
                                    <span class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded text-xs">
                                        ${getCategoryName(product.category)}
                                    </span>
                                </div>
                                <div class="mt-2 text-xs text-gray-500">
                                    üîó ${originalUrl}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Add product from admin preview
        async function adminAddFromPreview() {
            if (!currentAdminPreviewProduct) {
                showNotification('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á Preview ‡∏Å‡πà‡∏≠‡∏ô ‚ö†Ô∏è', 'error');
                return;
            }

            try {
                const addBtn = document.getElementById('adminAddFromPreviewBtn');
                const originalText = addBtn.textContent;
                addBtn.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°...';
                addBtn.disabled = true;

                const newProduct = {
                    name: currentAdminPreviewProduct.name,
                    originalPrice: currentAdminPreviewProduct.originalPrice,
                    salePrice: currentAdminPreviewProduct.salePrice,
                    category: currentAdminPreviewProduct.category,
                    image: currentAdminPreviewProduct.image,
                    description: currentAdminPreviewProduct.description,
                    affiliateLink: currentAdminPreviewProduct.affiliateLink,
                    createdAt: firebase.firestore ? firebase.firestore.FieldValue.serverTimestamp() : new Date(),
                    addedVia: 'link-preview'
                };

                let productId;
                if (db) {
                    // Add to Firestore
                    const docRef = await db.collection('products').add(newProduct);
                    productId = docRef.id;
                    console.log('Product added via Link Preview with ID:', productId);
                } else {
                    // Demo mode
                    productId = Date.now().toString();
                }

                // Add to local array with generated ID
                const addedProduct = {
                    id: productId,
                    ...newProduct,
                    createdAt: new Date()
                };
                
                allProducts.unshift(addedProduct);
                
                // Update filtered products if showing all or same category
                if (currentCategory === 'all' || currentCategory === currentAdminPreviewProduct.category) {
                    filteredProducts = currentCategory === 'all' ? [...allProducts] : allProducts.filter(p => p.category === currentCategory);
                    displayProducts(filteredProducts);
                }
                
                // Update displays
                loadHomePageProducts();
                updateProductStats();
                updateProductManagementList();
                updateRecentAddedProducts(addedProduct);
                
                // Clear form and preview
                document.getElementById('adminLinkPreviewInput').value = '';
                document.getElementById('adminLinkPreviewContainer').innerHTML = '';
                currentAdminPreviewProduct = null;

                addBtn.textContent = originalText;
                addBtn.disabled = true; // Disable until next preview

                showNotification('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å Link Preview ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‚úÖ', 'success');

            } catch (error) {
                console.error('Error adding product from admin preview:', error);
                showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚ùå', 'error');
                
                const addBtn = document.getElementById('adminAddFromPreviewBtn');
                addBtn.textContent = '‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤';
                addBtn.disabled = false;
            }
        }

        // Update recent added products list
        function updateRecentAddedProducts(newProduct) {
            const container = document.getElementById('recentAddedProducts');
            const recentProducts = allProducts.filter(p => p.addedVia === 'link-preview').slice(0, 5);
            
            if (recentProducts.length === 0) {
                container.innerHTML = '<p class="text-xs text-gray-500 text-center py-4">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å Link Preview</p>';
                return;
            }

            container.innerHTML = recentProducts.map(product => {
                const originalPrice = product.originalPrice || product.price || 0;
                const salePrice = product.salePrice || product.price || 0;
                const discount = getDiscountPercentage(originalPrice, salePrice);
                return `
                    <div class="flex items-center space-x-3 p-2 bg-white rounded border hover:shadow-sm transition">
                        <img src="${product.image}" alt="${product.name}" class="w-10 h-10 object-cover rounded">
                        <div class="flex-1">
                            <h6 class="font-medium text-xs">${product.name.length > 30 ? product.name.substring(0, 30) + '...' : product.name}</h6>
                            <div class="flex items-center space-x-1">
                                <span class="text-xs text-red-600 font-bold">‡∏ø${salePrice.toLocaleString()}</span>
                                ${discount > 0 ? `
                                    <span class="text-xs text-gray-400 line-through">‡∏ø${originalPrice.toLocaleString()}</span>
                                    <span class="text-xs bg-red-100 text-red-600 px-1 rounded">-${discount}%</span>
                                ` : ''}
                            </div>
                        </div>
                        <div class="flex space-x-1">
                            <button onclick="editProduct('${product.id}')" class="bg-blue-500 text-white px-1 py-1 rounded text-xs hover:bg-blue-600 transition">
                                ‚úèÔ∏è
                            </button>
                            <button onclick="deleteProduct('${product.id}')" class="bg-red-500 text-white px-1 py-1 rounded text-xs hover:bg-red-600 transition">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Generate Link Preview function with real URL fetching
        async function generateLinkPreview() {
            const input = document.getElementById('linkPreviewInput').value.trim();
            if (!input) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏´‡∏£‡∏∑‡∏≠ ID ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚ö†Ô∏è', 'error');
                return;
            }

            // Show loading state
            const generateBtn = document.querySelector('button[onclick="generateLinkPreview()"]');
            const originalText = generateBtn.textContent;
            generateBtn.textContent = 'üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
            generateBtn.disabled = true;

            let product = null;
            
            try {
                // Check if it's a URL that we can fetch metadata from
                if (input.startsWith('http')) {
                    product = await fetchUrlMetadata(input);
                    if (product) {
                        showNotification('‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üîó', 'success');
                    }
                }
                
                // Fallback to existing logic if URL fetch fails
                if (!product) {
                    // Check if it's a Shopee URL
                    if (input.includes('shopee.co.th') || input.includes('shopee.com')) {
                        product = extractShopeeInfo(input);
                        if (product) {
                            showNotification('‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Shopee ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üü†', 'success');
                        }
                    }
                    // Check if it's a Lazada URL
                    else if (input.includes('lazada.co.th') || input.includes('lazada.com')) {
                        product = extractLazadaInfo(input);
                        if (product) {
                            showNotification('‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Lazada ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üîµ', 'success');
                        }
                    }
                    // Check if it's a product ID from our database
                    else if (input.startsWith('product-') || /^\d+$/.test(input)) {
                        const productId = input.replace('product-', '');
                        product = allProducts.find(p => p.id === productId || p.id === input);
                    }
                    // If it's any other URL, try to extract info
                    else if (input.startsWith('http')) {
                        product = await extractGenericUrlInfo(input);
                        if (product) {
                            showNotification('‡∏™‡∏£‡πâ‡∏≤‡∏á Preview ‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üîó', 'success');
                        }
                    }
                }
                
                // If still no product found, use first product as demo
                if (!product && allProducts.length > 0) {
                    product = allProducts[0];
                    showNotification('‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Demo üì¶', 'success');
                }

                if (!product) {
                    showNotification('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á Preview ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô ‚ö†Ô∏è', 'error');
                    return;
                }

                const originalPrice = product.originalPrice || product.price || 0;
                const salePrice = product.salePrice || product.price || 0;
                const discount = getDiscountPercentage(originalPrice, salePrice);

                const linkPreview = createLinkPreview(product, input, discount);
                
                const container = document.getElementById('linkPreviewContainer');
                container.innerHTML = linkPreview + container.innerHTML; // Add to top
                
                // Clear input
                document.getElementById('linkPreviewInput').value = '';

            } catch (error) {
                console.error('Error generating link preview:', error);
                showNotification('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ó‡∏ô ‚ö†Ô∏è', 'error');
                
                // Fallback to demo data
                if (allProducts.length > 0) {
                    const product = allProducts[0];
                    const originalPrice = product.originalPrice || product.price || 0;
                    const salePrice = product.salePrice || product.price || 0;
                    const discount = getDiscountPercentage(originalPrice, salePrice);
                    const linkPreview = createLinkPreview(product, input, discount);
                    const container = document.getElementById('linkPreviewContainer');
                    container.innerHTML = linkPreview + container.innerHTML;
                    document.getElementById('linkPreviewInput').value = '';
                }
            } finally {
                // Reset button
                generateBtn.textContent = originalText;
                generateBtn.disabled = false;
            }
        }

        // Fetch URL metadata using multiple CORS proxies with fallback
        async function fetchUrlMetadata(url) {
            // List of CORS proxies to try
            const corsProxies = [
                `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`,
                `https://corsproxy.io/?${encodeURIComponent(url)}`,
                `https://cors-anywhere.herokuapp.com/${url}`,
                `https://thingproxy.freeboard.io/fetch/${url}`
            ];

            for (let i = 0; i < corsProxies.length; i++) {
                try {
                    console.log(`Trying CORS proxy ${i + 1}:`, corsProxies[i]);
                    
                    const response = await fetch(corsProxies[i], {
                        method: 'GET',
                        headers: {
                            'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
                            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                    
                    let htmlContent;
                    if (i === 0) { // allorigins returns JSON
                        const data = await response.json();
                        htmlContent = data.contents;
                    } else { // other proxies return HTML directly
                        htmlContent = await response.text();
                    }
                    
                    if (!htmlContent || htmlContent.length < 100) {
                        throw new Error('Empty or invalid content');
                    }
                    
                    console.log('‚úÖ Successfully fetched content from proxy', i + 1);
                    
                    // Parse HTML content to extract metadata
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(htmlContent, 'text/html');
                    
                    // Enhanced extraction for Shopee specifically
                    let title, description, image, prices;
                    
                    if (url.includes('shopee')) {
                        const shopeeData = extractShopeeMetadata(doc, htmlContent, url);
                        title = shopeeData.title;
                        description = shopeeData.description;
                        image = shopeeData.image;
                        prices = shopeeData.prices;
                    } else {
                        // Generic extraction
                        title = extractMetaContent(doc, [
                            'meta[property="og:title"]',
                            'meta[name="twitter:title"]',
                            'meta[property="twitter:title"]',
                            'title',
                            'h1'
                        ]) || extractTitleFromUrl(url);
                        
                        description = extractMetaContent(doc, [
                            'meta[property="og:description"]',
                            'meta[name="twitter:description"]',
                            'meta[property="twitter:description"]',
                            'meta[name="description"]'
                        ]) || '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏©';
                        
                        image = extractMetaContent(doc, [
                            'meta[property="og:image"]',
                            'meta[name="twitter:image"]',
                            'meta[property="twitter:image"]'
                        ]);
                        
                        // Extract price if available
                        const priceText = extractPriceFromContent(htmlContent);
                        prices = priceText ? parsePriceText(priceText) : null;
                    }
                    
                    // Clean up extracted data
                    title = cleanText(title);
                    description = cleanText(description);
                    
                    // Validate image URL
                    if (image && !image.startsWith('http')) {
                        if (image.startsWith('//')) {
                            image = 'https:' + image;
                        } else if (image.startsWith('/')) {
                            const urlObj = new URL(url);
                            image = urlObj.origin + image;
                        }
                    }
                    
                    // Detect category from content
                    const category = detectCategoryFromContent(htmlContent, url);
                    
                    // Use extracted prices or generate mock prices
                    if (!prices) {
                        prices = generateMockPrices(category);
                    }
                    
                    const product = {
                        id: 'fetched-' + Date.now(),
                        name: title.substring(0, 100),
                        originalPrice: prices.original,
                        salePrice: prices.sale,
                        category: category,
                        image: image || getDefaultImageForCategory(category),
                        description: description.substring(0, 200),
                        affiliateLink: url,
                        isFetchedProduct: true,
                        fetchedAt: new Date().toISOString(),
                        source: `CORS Proxy ${i + 1}`
                    };
                    
                    console.log('‚úÖ Successfully extracted product data:', product);
                    return product;
                    
                } catch (error) {
                    console.warn(`‚ùå CORS proxy ${i + 1} failed:`, error.message);
                    if (i === corsProxies.length - 1) {
                        console.error('All CORS proxies failed');
                    }
                }
            }
            
            return null;
        }

        // Enhanced Shopee metadata extraction
        function extractShopeeMetadata(doc, htmlContent, url) {
            let title = '';
            let description = '';
            let image = '';
            let prices = null;
            
            try {
                // Try to extract from JSON-LD structured data
                const scripts = doc.querySelectorAll('script[type="application/ld+json"]');
                for (const script of scripts) {
                    try {
                        const data = JSON.parse(script.textContent);
                        if (data['@type'] === 'Product' || data.name) {
                            title = data.name || title;
                            description = data.description || description;
                            if (data.image) {
                                image = Array.isArray(data.image) ? data.image[0] : data.image;
                                if (typeof image === 'object' && image.url) {
                                    image = image.url;
                                }
                            }
                            if (data.offers && data.offers.price) {
                                const price = parseFloat(data.offers.price);
                                prices = {
                                    original: Math.round(price * 1.2),
                                    sale: Math.round(price)
                                };
                            }
                        }
                    } catch (e) {
                        // Continue to next script
                    }
                }
                
                // Try to extract from window.__INITIAL_STATE__ or similar
                const initialStateMatch = htmlContent.match(/window\.__INITIAL_STATE__\s*=\s*({.+?});/);
                if (initialStateMatch) {
                    try {
                        const initialState = JSON.parse(initialStateMatch[1]);
                        // Navigate through Shopee's data structure
                        if (initialState.item && initialState.item.name) {
                            title = initialState.item.name;
                            description = initialState.item.description || description;
                            if (initialState.item.image) {
                                image = `https://cf.shopee.co.th/file/${initialState.item.image}`;
                            }
                            if (initialState.item.price) {
                                const price = initialState.item.price / 100000; // Shopee stores price in different format
                                prices = {
                                    original: Math.round(price * 1.2),
                                    sale: Math.round(price)
                                };
                            }
                        }
                    } catch (e) {
                        console.warn('Failed to parse Shopee initial state:', e);
                    }
                }
                
                // Fallback to meta tags and DOM elements
                if (!title) {
                    title = extractMetaContent(doc, [
                        'meta[property="og:title"]',
                        'meta[name="twitter:title"]',
                        'title',
                        '.product-name',
                        'h1'
                    ]);
                }
                
                if (!description) {
                    description = extractMetaContent(doc, [
                        'meta[property="og:description"]',
                        'meta[name="description"]',
                        '.product-description'
                    ]);
                }
                
                if (!image) {
                    image = extractMetaContent(doc, [
                        'meta[property="og:image"]',
                        'meta[name="twitter:image"]'
                    ]);
                }
                
                // Extract price from various selectors
                if (!prices) {
                    const priceSelectors = [
                        '.product-price',
                        '.price',
                        '[class*="price"]',
                        '[data-price]'
                    ];
                    
                    for (const selector of priceSelectors) {
                        const priceElement = doc.querySelector(selector);
                        if (priceElement) {
                            const priceText = priceElement.textContent || priceElement.getAttribute('data-price');
                            if (priceText) {
                                const extractedPrices = parsePriceText(priceText);
                                if (extractedPrices) {
                                    prices = extractedPrices;
                                    break;
                                }
                            }
                        }
                    }
                }
                
            } catch (error) {
                console.warn('Error in Shopee metadata extraction:', error);
            }
            
            return {
                title: title || extractTitleFromUrl(url),
                description: description || '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å Shopee ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏©',
                image: image,
                prices: prices || generateMockPrices('mobile')
            };
        }

        // Clean extracted text
        function cleanText(text) {
            if (!text) return '';
            return text
                .replace(/\s+/g, ' ')
                .replace(/[\r\n\t]/g, ' ')
                .trim()
                .replace(/&amp;/g, '&')
                .replace(/&lt;/g, '<')
                .replace(/&gt;/g, '>')
                .replace(/&quot;/g, '"')
                .replace(/&#39;/g, "'");
        }

        // Extract generic URL info as fallback
        async function extractGenericUrlInfo(url) {
            const urlParts = url.split('/');
            const lastPart = urlParts[urlParts.length - 1] || urlParts[urlParts.length - 2];
            let productName = lastPart.replace(/[-_]/g, ' ').replace(/\b\w/g, l => l.toUpperCase()) || '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå';
            
            // Clean up common URL patterns
            productName = productName.replace(/\.(html|php|aspx?)$/i, '');
            productName = productName.replace(/\?.*$/, ''); // Remove query parameters
            
            const category = detectCategoryFromUrl(url);
            const mockPrices = generateMockPrices(category);
            
            return {
                id: 'generic-' + Date.now(),
                name: productName,
                originalPrice: mockPrices.original,
                salePrice: mockPrices.sale,
                category: category,
                image: getDefaultImageForCategory(category),
                description: `‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ${getCategoryName(category)} ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ`,
                affiliateLink: url,
                isGenericProduct: true
            };
        }

        // Helper function to extract meta content
        function extractMetaContent(doc, selectors) {
            for (const selector of selectors) {
                const element = doc.querySelector(selector);
                if (element) {
                    return element.getAttribute('content') || element.textContent || element.innerText;
                }
            }
            return null;
        }

        // Extract title from URL if no meta title found
        function extractTitleFromUrl(url) {
            const urlParts = url.split('/');
            const lastPart = urlParts[urlParts.length - 1] || urlParts[urlParts.length - 2];
            return lastPart.replace(/[-_]/g, ' ').replace(/\b\w/g, l => l.toUpperCase()) || '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå';
        }

        // Extract price information from HTML content
        function extractPriceFromContent(htmlContent) {
            // Look for common price patterns
            const pricePatterns = [
                /‡∏ø[\d,]+/g,
                /\$[\d,]+\.?\d*/g,
                /price["\s]*:[\s]*[\d,]+/gi,
                /‡∏£‡∏≤‡∏Ñ‡∏≤[\s]*:?[\s]*[\d,]+/gi
            ];
            
            for (const pattern of pricePatterns) {
                const matches = htmlContent.match(pattern);
                if (matches && matches.length > 0) {
                    return matches[0];
                }
            }
            return null;
        }

        // Parse price text to extract numbers
        function parsePriceText(priceText) {
            const numbers = priceText.match(/[\d,]+/g);
            if (numbers && numbers.length > 0) {
                const price = parseInt(numbers[0].replace(/,/g, ''));
                return {
                    original: price,
                    sale: Math.floor(price * 0.8) // 20% discount
                };
            }
            return generateMockPrices('mobile');
        }

        // Detect category from HTML content
        function detectCategoryFromContent(htmlContent, url) {
            const contentLower = htmlContent.toLowerCase();
            const urlLower = url.toLowerCase();
            
            const categoryKeywords = {
                mobile: ['phone', 'mobile', 'iphone', 'samsung', 'smartphone', '‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠', '‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå'],
                computer: ['laptop', 'computer', 'macbook', 'pc', '‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå', '‡πÅ‡∏•‡πá‡∏õ‡∏ó‡πá‡∏≠‡∏õ'],
                fashion: ['fashion', 'clothing', 'shirt', 'dress', 'shoes', '‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô', '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤', '‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤'],
                mother: ['baby', 'kids', 'mother', 'child', '‡πÄ‡∏î‡πá‡∏Å', '‡πÅ‡∏°‡πà', '‡∏ó‡∏≤‡∏£‡∏Å'],
                home: ['home', 'garden', 'furniture', 'decor', '‡∏ö‡πâ‡∏≤‡∏ô', '‡∏™‡∏ß‡∏ô', '‡πÄ‡∏ü‡∏≠‡∏£‡πå‡∏ô‡∏¥‡πÄ‡∏à‡∏≠‡∏£‡πå'],
                health: ['health', 'vitamin', 'supplement', 'beauty', '‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û', '‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô', '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡∏≤‡∏°']
            };
            
            for (const [category, keywords] of Object.entries(categoryKeywords)) {
                for (const keyword of keywords) {
                    if (contentLower.includes(keyword) || urlLower.includes(keyword)) {
                        return category;
                    }
                }
            }
            
            return 'mobile'; // Default category
        }

        // Create Link Preview HTML
        function createLinkPreview(product, originalUrl, discount = 0) {
            const originalPrice = product.originalPrice || product.price || 0;
            const salePrice = product.salePrice || product.price || 0;
            const displayPrice = salePrice || product.price || 0;
            
            return `
                <div class="border border-gray-300 rounded-lg overflow-hidden hover:shadow-md transition bg-white">
                    <div class="flex">
                        <div class="w-32 h-32 flex-shrink-0">
                            <img src="${product.image}" alt="${product.name}" class="w-full h-full object-cover">
                        </div>
                        <div class="flex-1 p-4">
                            <div class="flex justify-between items-start mb-2">
                                <h3 class="font-semibold text-lg text-blue-600 hover:text-blue-800 cursor-pointer" onclick="showProductDetail('${product.id}')">
                                    ${product.name}${discount > 0 ? ` - ‡∏•‡∏î ${discount}%` : ''}
                                </h3>
                                ${discount > 0 ? `
                                    <span class="bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold">
                                        -${discount}%
                                    </span>
                                ` : ''}
                            </div>
                            <p class="text-gray-600 text-sm mb-3 line-clamp-2">${product.description}</p>
                            <div class="flex justify-between items-center">
                                <div>
                                    <span class="text-xl font-bold text-red-600">‡∏ø${displayPrice.toLocaleString()}</span>
                                    ${discount > 0 ? `
                                        <span class="text-sm text-gray-500 line-through ml-2">‡∏ø${originalPrice.toLocaleString()}</span>
                                    ` : ''}
                                </div>
                                <div class="flex space-x-2">
                                    <button onclick="addToCart('${product.id}')" class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition">
                                        üõí ‡πÄ‡∏û‡∏¥‡πà‡∏°
                                    </button>
                                    ${product.affiliateLink ? `
                                        <a href="${product.affiliateLink}" target="_blank" class="bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition">
                                            üõçÔ∏è ‡∏ã‡∏∑‡πâ‡∏≠
                                        </a>
                                    ` : ''}
                                </div>
                            </div>
                            <div class="mt-2 text-xs text-gray-500">
                                üåê ${originalUrl.startsWith('http') ? originalUrl : `https://flashsale-thailand.com/product/${product.id}`}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Load sample previews
        function loadSamplePreviews() {
            const container = document.getElementById('samplePreviews');
            if (!container || allProducts.length === 0) return;

            const sampleProducts = allProducts.slice(0, 3);
            container.innerHTML = sampleProducts.map((product, index) => {
                const originalPrice = product.originalPrice || product.price || 0;
                const salePrice = product.salePrice || product.price || 0;
                const discount = getDiscountPercentage(originalPrice, salePrice);
                const sampleUrl = `https://flashsale-thailand.com/product/${product.id}`;
                return createLinkPreview(product, sampleUrl, discount);
            }).join('');
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
            initDraggableModal();
            initModalScroll();

            // Cart modal
            document.getElementById('cartBtn').addEventListener('click', showCartModal);
            document.getElementById('closeCartModal').addEventListener('click', () => {
                document.getElementById('cartModal').classList.add('hidden');
            });

            // Admin modal
            document.getElementById('adminBtn').addEventListener('click', () => {
                document.getElementById('adminModal').classList.remove('hidden');
            });
            document.getElementById('closeAdminModal').addEventListener('click', () => {
                document.getElementById('adminModal').classList.add('hidden');
            });

            // Admin functions
            document.getElementById('loginBtn').addEventListener('click', adminLogin);
            document.getElementById('addProductBtn').addEventListener('click', addProduct);
            document.getElementById('logoutBtn').addEventListener('click', logout);

            // Smart product functions
            document.getElementById('toggleManualForm').addEventListener('click', toggleManualForm);
            document.getElementById('previewProductBtn').addEventListener('click', previewSmartProduct);
            document.getElementById('addSmartProductBtn').addEventListener('click', addSmartProduct);

            // Auto generation functions
            document.getElementById('generateProductsBtn').addEventListener('click', generateProducts);
            document.getElementById('bulkUpdatePriceBtn').addEventListener('click', bulkUpdatePrices);
            document.getElementById('bulkDeleteBtn').addEventListener('click', bulkDeleteProducts);

            // Product management functions
            document.getElementById('manageCategory').addEventListener('change', function() {
                updateProductManagementList(this.value);
            });

            // Edit product modal
            document.getElementById('closeEditModal').addEventListener('click', () => {
                document.getElementById('editProductModal').classList.add('hidden');
            });
            document.getElementById('cancelEditBtn').addEventListener('click', () => {
                document.getElementById('editProductModal').classList.add('hidden');
            });
            document.getElementById('saveEditBtn').addEventListener('click', saveEditedProduct);

            // Product detail modal
            document.getElementById('closeProductDetailModal').addEventListener('click', () => {
                document.getElementById('productDetailModal').classList.add('hidden');
            });

            // Contact form
            document.querySelector('#contactPage form').addEventListener('submit', function(e) {
                e.preventDefault();
                showNotification('‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡πÉ‡∏ô‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ üìß');
                this.reset();
            });

            // Close modals on outside click
            document.getElementById('cartModal').addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    e.currentTarget.classList.add('hidden');
                }
            });
            document.getElementById('adminModal').addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    e.currentTarget.classList.add('hidden');
                }
            });
            document.getElementById('editProductModal').addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    e.currentTarget.classList.add('hidden');
                }
            });
            document.getElementById('productDetailModal').addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    e.currentTarget.classList.add('hidden');
                }
            });
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96fa7fe0f37d10d2',t:'MTc1NTI3OTg2Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

